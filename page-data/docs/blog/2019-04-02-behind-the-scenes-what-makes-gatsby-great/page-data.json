{"componentChunkName":"component---src-templates-blog-post-js","path":"/docs/blog/2019-04-02-behind-the-scenes-what-makes-gatsby-great/","result":{"data":{"site":{"siteMetadata":{"title":"Gatsby Starter Blog"}},"markdownRemark":{"id":"4ea20e34-fd9e-5d86-ba8d-308b70e5eccc","excerpt":"Gatsby is great from a multitude of perspectives. Our community is great. The developer experience is great. The performance of the resulting application is‚Ä¶","html":"<p>Gatsby is <strong>great</strong> from a multitude of perspectives. Our community is <strong>great</strong>. The developer experience is <strong>great</strong>. The performance of the resulting application is <strong>great</strong>. Our documentation is <strong>great</strong>. And so on and so forth‚Ä¶ if I were to focus on <em>each</em> of these areas, this post would become an overly long love letter that I‚Äôm not sure many would want to read.</p>\n<p>As such‚Äîthis post focuses on just a single element of what makes Gatsby great: performance. To prime the discussion, let‚Äôs consider <a href=\"https://www.reddit.com/r/webdev/comments/9z5dsr/how_does_reactjs_have_such_a_fast_website/?st=jtqbllhm&#x26;sh=60148ea7\">this post on the <code class=\"language-text\">webdev</code> subreddit on Reddit</a>.</p>\n<Pullquote citation=\"reddit/r/webdev\">\n  Genuine question, every page is loaded immediately [sic] on click. Seriously\n  never seen such a quick website before. Any insight as to how they're able to\n  achieve this?\n</Pullquote>\n<p>Fun fact‚Äîthat website in question is <a href=\"https://reactjs.org\">reactjs.org</a> which, as you may or may not know, is an application built with and powered by Gatsby üí™</p>\n<p>In an effort to answer this initial question, this post outlines several foundational techniques that Gatsby enables <em>by default</em> to deliver this experience. Specifically:</p>\n<ol>\n<li>Server-side rendering (SSR) at <strong>build time</strong></li>\n<li>Route-based code splitting</li>\n<li>Modern APIs</li>\n</ol>\n<p>Finally, this post concludes with tangible, practical advice for measuring and asserting conclusively that your app is <em>actually</em> ludicrously fast.</p>\n<p>Let‚Äôs dive deep.</p>\n<h2>Server-side rendering (SSR) at <strong>build time</strong></h2>\n<p>The mental model many hold for Gatsby is that of the static-site generator. This is accurate (with a caveat that it‚Äôs excellent for <a href=\"/gatsby-bloga-2/blog/2018-11-07-gatsby-for-apps/\">web applications, too</a>). Gatsby <em>excels</em> at producing optimized static content (HTML, CSS, JavaScript, images, etc.) that can be deployed <em>anywhere</em> for pennies. Gatsby produces optimized static content by invoking server-side APIs at <strong>build time</strong>. But, but‚Ä¶ you say‚Äî‚ÄúGatsby is <em>just</em> a static site generator, it‚Äôs not server-side rendered!‚Äù Let‚Äôs put down the pitchforks‚Äîlet me explain!</p>\n<p>Server-side rendering at build time merely means that we invoke the same server-side APIs invoked by a traditional server-side rendered application. We render a React component to optimized, pre-rendered HTML. If we first consider a React component, e.g.</p>\n<div class=\"gatsby-highlight\" data-language=\"jsx:title=src/pages/index.js\"><pre class=\"language-jsx:title=src/pages/index.js\"><code class=\"language-jsx:title=src/pages/index.js\">import React from &quot;react&quot;\n\nimport { Layout } from &quot;../components/layout&quot;\n\nexport default function IndexPage() {\n  return (\n    &lt;Layout&gt;\n      &lt;h1&gt;Hello World&lt;/h1&gt;\n    &lt;/Layout&gt;\n  )\n}</code></pre></div>\n<p>this <em>page</em> will be rendered and optimized by Gatsby‚Äôs approach of invoking server-side APIs at <strong>build time</strong>. That process looks a little bit like:</p>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token keyword\">const</span> path <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">path</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">const</span> fs <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">fs</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">const</span> React <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">react</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> renderToStaticMarkup <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">react-dom/server</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">const</span> Html <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">../html</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span> <span class=\"token comment\">// the HTML template</span>\n\nmodule<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">exports</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span> <span class=\"token function\">renderPage</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">template<span class=\"token punctuation\">,</span> pagePath<span class=\"token punctuation\">,</span> props</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> htmlContent <span class=\"token operator\">=</span> <span class=\"token function\">renderToStaticMarkup</span><span class=\"token punctuation\">(</span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Html</span></span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">{</span>React<span class=\"token punctuation\">.</span><span class=\"token function\">createElement</span><span class=\"token punctuation\">(</span><span class=\"token function\">require</span><span class=\"token punctuation\">(</span>path<span class=\"token punctuation\">.</span><span class=\"token function\">resolve</span><span class=\"token punctuation\">(</span>template<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> props<span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span><span class=\"token class-name\">Html</span></span><span class=\"token punctuation\">></span></span>\n  <span class=\"token punctuation\">)</span>\n\n  fs<span class=\"token punctuation\">.</span><span class=\"token function\">writeFileSync</span><span class=\"token punctuation\">(</span>path<span class=\"token punctuation\">.</span><span class=\"token function\">join</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">public</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">,</span> pagePath<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> htmlContent<span class=\"token punctuation\">,</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">utf8</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p><em>Note: want to see the actual code? <a href=\"https://github.com/gatsbyjs/gatsby/blob/master/packages/gatsby/cache-dir/static-entry.js\">Check it</a></em></p>\n<p>This produces optimized, pre-rendered HTML for <em>every</em> page in your application. It ends up looking something like this:</p>\n<div class=\"gatsby-highlight\" data-language=\"html:title=public/index.html\"><pre class=\"language-html:title=public/index.html\"><code class=\"language-html:title=public/index.html\">&lt;div id=&quot;___gatsby&quot;&gt;\n  &lt;main&gt;\n    &lt;h1&gt;Hello World&lt;/h1&gt;\n  &lt;/main&gt;\n&lt;/div&gt;</code></pre></div>\n<p>Your React components are traced, rendered, and static HTML is produced via server-side APIs. Great. Why?</p>\n<h3>Why server-side render?</h3>\n<p>First: let‚Äôs consider the scenario in which we are not server-side rendering, e.g. a traditional React application produced by something like <a href=\"https://github.com/facebook/create-react-app\">create-react-app</a>. This application once deployed <strong>requires</strong> JavaScript to parse, render, and eventually produce HTML to the <a href=\"https://developer.mozilla.org/en-US/docs/Web/API/Document_Object_Model\">DOM</a>. This <em>eventuality</em> means that your users are waiting for JavaScript to be parsed and evaluated before your application is usable. It also‚Äîof course‚Äî<em>requires</em> JavaScript.</p>\n<p>Short circuiting this process and turning this <em>eventuality</em> into a certainty is the key win of server-side rendering. This process produces static HTML that does not require JavaScript to run. Your application will load much more quickly and will be interactive more quickly. You will improve <a href=\"https://developer.mozilla.org/en-US/docs/Glossary/SEO\">Search Engine Optimization</a> because search engines can more quickly, reliably, and accurately parse your content and <code class=\"language-text\">meta</code> tags.</p>\n<p>Your user‚Äôs time isn‚Äôt wasted to <em>eventually</em> render your application. We render your application at <em>build time</em> (as much as possible!) to maximize performance and deliver the ‚ö° fast experience your users expect. Why force the work and time on your user when we can short-circuit this process and render the application <em>for them</em> at build time?</p>\n<p>This is the central idea of server-side rendering. Gatsby uses server-side APIs to render your application at <strong>build time</strong> so your users get a usable application much more quickly, even when JavaScript is disabled. Nifty. You‚Äôre probably jumping ahead of me at this point. Why perform this process at build-time‚Äîthis is what Gatsby does‚Äîwhen we could perform this work at <em>request</em> time with traditional server-side rendering approaches?</p>\n<h3>Zero Node.js servers required ‚úã</h3>\n<p><a href=\"https://twitter.com/jlengstorf/status/1090659696233463808\">https://twitter.com/jlengstorf/status/1090659696233463808</a></p>\n<p>To begin describing why build-time SSR is so appealing, let‚Äôs first take a look at what a deploy and release looks like if we don‚Äôt require a server. What‚Äôs required for a typical set-up for deploying static content (which Gatsby produces)? It looks something like:</p>\n<ul>\n<li>\n<p>Creating a <a href=\"https://developer.mozilla.org/en-US/docs/Glossary/CDN\">Content Delivery Network</a> to route your content <em>as close as possible</em> to where your users are requesting it</p>\n<ul>\n<li>This is often called ‚Äúon the edge‚Äù and Gatsby can and should be deployed on the edge‚Äî<a href=\"https://www.cloudflare.com/learning/cdn/glossary/edge-server/\">it reduces latency and improves page-load times</a></li>\n</ul>\n</li>\n<li>Creating a bucket/location to host static content (like S3, Google Cloud Storage, etc.)</li>\n<li>Setting up a <a href=\"https://developer.mozilla.org/en-US/docs/Learn/Common_questions/What_is_a_domain_name\">Domain Name System (DNS)</a> to make your content reachable via a pretty URL, e.g. gatsbyjs.org</li>\n<li>Routing the CDN layer in front of your static content</li>\n<li>Set up a Continuous Integration (CI) environment so we can build and deploy code to production with minimal impact to end users</li>\n</ul>\n<p>‚Ä¶ and, that‚Äôs it! We‚Äôre done as far as setup goes! We can use <em>whatever</em> stack you prefer here. Netlify? <a href=\"https://www.gatsbyjs.org/docs/deploying-to-netlify\">You bet.</a> More a fan of AWS? <a href=\"https://www.gatsbyjs.org/docs/deploying-to-aws-amplify/\">Of course.</a> Heroku? <a href=\"https://www.gatsbyjs.org/docs/deploying-to-heroku/\">Yup.</a> You get the idea. Gatsby can be deployed anywhere easily and cheaply.</p>\n<p>We now have an infrastructure setup so that we <em>can</em> release our web application. What‚Äôs a release look like?</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">gatsby build</code></pre></div>\n<p>and then copying the result of <code class=\"language-text\">gatsby build</code> (the <code class=\"language-text\">public</code> folder) to your static content host of choice.</p>\n<p>That‚Äôs it. What if your site goes viral and receives hundreds of thousands of requests? You get charged in <strong>terrabytes</strong> of data with most CDNs, and that cost is quite literally <a href=\"https://aws.amazon.com/cloudfront/pricing/\">pennies</a>. Deploying a new version of your app? Fire off a deploy and your users will have the new version available the instant the build process completes.</p>\n<p>Let‚Äôs contrast this approach with setting up and deploying a purely server-side rendered application.</p>\n<h4>Deploying a server-side rendered application</h4>\n<p>First: perform the <strong>same</strong> steps in setting up a static content host. Oh and we‚Äôre not done yet, sweet, sweet summer child.</p>\n<p><img src=\"https://media1.tenor.com/images/0ae8734d4f4184e8ac3d9f6032d0047f/tenor.gif?itemid=5580217\" alt=\"Sweet, Sweet Summer Child\"></p>\n<p>Next:</p>\n<ul>\n<li>\n<p>Set up and provision several <a href=\"https://en.wikipedia.org/wiki/Virtual_machine\">virtual machines (VM)</a> to run instance(s) of our server-side app</p>\n<ul>\n<li>Traditional examples are something like <a href=\"https://aws.amazon.com/ec2/\">EC2</a></li>\n</ul>\n</li>\n<li>\n<p>Configure the VM to be able to run Node.js code</p>\n<ul>\n<li>Consider using <a href=\"https://www.docker.com/\">Docker</a> to ensure you have a consistent Node.js environment</li>\n</ul>\n</li>\n<li>\n<p>Set up auto-scaling to ensure we can accommodate and fall-over based upon heavy load or error states</p>\n<ul>\n<li>Consider using <a href=\"https://kubernetes.io/\">Kubernetes</a>, <a href=\"https://rancher.com/\">Rancher</a>, etc.</li>\n</ul>\n</li>\n</ul>\n<p>Does this sound like something that sparks joy? ‚ú®Oh‚Äîlet‚Äôs talk about the deploy process, too.</p>\n<p>Releasing a one-line fix to our SSR application requires deploying an entirely new version of our application. This means spinning down existing versions of our service, spinning up new versions of our service, and handling and remediating any errors that may arise.</p>\n<p>The benefits of <em>both</em> approaches are the same. Improved performance (which has other, important related benefits) by short-circuiting the process of <em>eventually</em> producing HTML by directly producing HTML. However‚Äîdeploying and hosting static content is objectively <strong>easier</strong>, <strong>cheaper</strong>, and <strong>more reliable</strong> than deploying a server for rendering applications.</p>\n<p>Let‚Äôs continue.</p>\n<h2>Route-based code splitting</h2>\n<p>Gatsby‚Äîlike other tools‚Äîuses the filesystem as a convention for mapping to routes for instance, given the following directory structure:</p>\n<p><em>also note we expose a <a href=\"/gatsby-bloga-2/docs/node-apis/#createPages\">programmatic API</a> for dynamic route creation</em></p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">‚îú‚îÄ‚îÄ src/\n  ‚îú‚îÄ‚îÄ pages/\n    ‚îî‚îÄ‚îÄ about.js\n    ‚îî‚îÄ‚îÄ contact.js\n    ‚îî‚îÄ‚îÄ index.js</code></pre></div>\n<p>The <em>routes</em> (e.g. the URL the user enters or navigates to in the website) <code class=\"language-text\">/about</code>, <code class=\"language-text\">/contact</code>, and <code class=\"language-text\">/</code> will be available in the resulting application. Let‚Äôs take a look at one of these routes.</p>\n<div class=\"gatsby-highlight\" data-language=\"jsx:title=src/pages/contact.js\"><pre class=\"language-jsx:title=src/pages/contact.js\"><code class=\"language-jsx:title=src/pages/contact.js\">import React from &quot;react&quot;\nimport { Formik } from &quot;formik&quot;\nimport * as yup from &quot;yup&quot;\n\nimport { Layout } from &quot;../components/layout&quot;\n\nconst handleSubmit = values =&gt; {\n  // submit the form\n}\n\nexport default function Contact() {\n  return (\n    &lt;Layout&gt;\n      &lt;Formik\n        initialValues={{ email: ``, name: ``, message: `` }}\n        onSubmit={handleSubmit}\n        validationSchema={yup.object().shape({\n          email: yup.string().email().required(),\n          name: yup.string().required(),\n          message: yup.string().required(),\n        })}\n      &gt;\n        {props =&gt; (\n          &lt;form onSubmit={props.onSubmit}&gt;{/* the rendered form */}&lt;/form&gt;\n        )}\n      &lt;/Formik&gt;\n    &lt;/Layout&gt;\n  )\n}</code></pre></div>\n<p>Pretty vanilla looking component! We are rendering a <code class=\"language-text\">form</code> with some validation and functionality provided by the excellent libraries <a href=\"https://www.npmjs.com/package/yup\"><code class=\"language-text\">yup</code></a> and <a href=\"https://github.com/jaredpalmer/formik\"><code class=\"language-text\">Formik</code></a>. The likelihood that these libraries are used in <em>all</em> routes in our application is unlikely‚Äîyet this is traditionally the approach that many take with bundling their client-side JS libraries. This means that even if a particular route (e.g. <code class=\"language-text\">/about</code>) is <em>not using</em> certain libraries that they will still likely be included in a monolithic JavaScript bundle containing all dependencies. However‚ÄîGatsby, your friendly <em>web app compiler</em>, is a little smarter!</p>\n<p>We use code-splitting (enabled via our internalized dependency <a href=\"https://webpack.js.org\">webpack</a>), and in particular, our approach prioritizes app-level dependencies (libraries used by the majority or all routes) coupled with route-based code splitting for dependencies that are likely only used on a particular route. To more fully understand this, let‚Äôs take a look at a sample structure produced by our build process: <code class=\"language-text\">gatsby build</code>.</p>\n<div class=\"gatsby-highlight\" data-language=\"text:title=public/\"><pre class=\"language-text:title=public/\"><code class=\"language-text:title=public/\">‚îú‚îÄ‚îÄ 404\n‚îÇ   ‚îî‚îÄ‚îÄ index.html\n‚îú‚îÄ‚îÄ 9-f5d9c17474395c2890a3.js # highlight-line\n‚îú‚îÄ‚îÄ about\n‚îÇ   ‚îî‚îÄ‚îÄ index.html\n‚îú‚îÄ‚îÄ app-2abedacd9bf03aaca373.js # highlight-line\n‚îú‚îÄ‚îÄ component---src-pages-404-js-295c3d4f21322761edff.js\n‚îú‚îÄ‚îÄ component---src-pages-about-js-3997b0d76203b183f5b3.js\n‚îú‚îÄ‚îÄ component---src-pages-contact-js-34c976efa1482a119a50.js\n‚îú‚îÄ‚îÄ component---src-pages-index-js-764f0d722c982d3d2789.js\n‚îú‚îÄ‚îÄ contact\n‚îÇ   ‚îî‚îÄ‚îÄ index.html # highlight-line\n‚îî‚îÄ‚îÄ index.html</code></pre></div>\n<p>Let‚Äôs take a deeper look at some of those JavaScript files.</p>\n<h3><code class=\"language-text\">app.{unique-hash}.js</code></h3>\n<p><code class=\"language-text\">app-2abedacd9bf03aaca373.js</code> in the above example is our commons bundle. It contains the shared dependencies for all routes. This can be cached between routes, so that JavaScript libraries like:</p>\n<ul>\n<li><code class=\"language-text\">react</code></li>\n<li><code class=\"language-text\">react-dom</code></li>\n<li><code class=\"language-text\">@reach/router</code></li>\n<li><code class=\"language-text\">react-helmet</code></li>\n</ul>\n<p>are bundled on <em>every</em> route because they are used on <em>every</em> route.</p>\n<h3><code class=\"language-text\">{0-9}-{unique-hash}.js</code></h3>\n<p><code class=\"language-text\">9-f5d9c17474395c2890a3.js</code> in the above example is our route-based code splitting, in action. This will contain the separate dependencies that are required by our <code class=\"language-text\">/contact</code> route, specifically <code class=\"language-text\">Formik</code>, <code class=\"language-text\">yup</code>, etc. based on the previous example. This means that each route is only downloading the necessary JavaScript to make the page functional. No more and no less.</p>\n<p>Consider the output of <a href=\"https://github.com/webpack-contrib/webpack-bundle-analyzer\"><code class=\"language-text\">webpack-bundle-analyzer</code></a>, which makes this even clearer.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/gatsby-bloga-2/static/081210eb1342fb8de549da3465a2cfad/29007/bundle-analyzer.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 75%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAIAAABr+ngCAAAACXBIWXMAAAsSAAALEgHS3X78AAADZElEQVQozzXS/U8aBxgH8Pv/lv20H5ZuyV5+WdKk2Wwz13bpWq1WStUKgqCClRZPkXdbXlTuKu8CB9x5vB1wAgfCvcABdwiMimWsy5JPnnzzTZ7k+eEB6iGEOvFWPf6aJ4Ac2sOgKbxn9L8zfMnGIGgMgcaCC6rBwcppgPV7o6bGxsOJ+tFIt3gLVE59RZODtLgurW7C+AEHrfDGjle9Cyk1yA6Y1ptxvTl3YCdNjoLRiSlVp4rc/M+f/vqeUTwYAzVfpOyEqyc+wn4c0RtT5g+kAyo6oPz70yoUaHgjlRNfyQmXHTBpPY6/fB3W4RF44tgd6F6MgCaebWKZKS6ZKvrPGwjWxnM8nm1hmUGrM2x32wTJRFEKChQt7tDDOf92IuAZGRU95R9joNdgRoI46ghTN0LvU1f8u9MddcUB12qmCTaBX3kjJQdEHNgzby2eu/ddkvDazPjRV8OFO2OgW6uLXEug2R7bFBhOZP4N4lSdqbg+EjY3sW8n9qzIzn5Wb0WlMh+Ib25/Xl3qqdeHAFO4zCTQTDxJYBfpeAJH4sVUJofhlXRObLDD637OcISsaWIaENMasFcy85vEnWeNH55WH8h5QKjTg3ZnwLf7Lb7//5w2YoNhiGIpHINm56NSZWRRHpNp/Xd/t6kDK2Dn21n+6195YFBlx63eDSd8IU7z7RR/fcN0SIMTVU+vPEjJ3nrvzWFSLfzjfWgvbIsOn2w2ZxUskK3FMSp0QYX/E8udRVJQLAufpzwfg7azsD2W9kRRVyBkiSTdSMzsSJJ/uj/PHPWfngyAw7p+g3q9Ra1vVde3a0p59tUKtrQcX3x+9mQ1IVnDpeqKXNNQaWm1pqF+w8mNVEqZnDwPD5ejQ+CcD4S6Xm/z1EM7Ydbt5t4bab2uvKUi1jYrMkV5WVaUvMTm1vKSFeLFauaxikR/QibfnI9+SUw/jK9ydY7rcgU+h7JIsOl1M0cHV7ptSiEpPNOUlRWxlOPSJJ8/pMAFdGargYJXt648DVfaAHNNMyKdb2eTHAJRx0dVk76qVZZWpMX5x9nfNBVli2sKojAZTaz1w3sX3+130LIwpFcXeBQBLnuFi17Cx0JB+gzmjh2sDaztTndU5dUVcgGs7ZDdQqFLFNqEhTIsZWat/UyhO6DROEPT/wAwcLLgUeSUMQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"webpack Bundle Analyzer\"\n        title=\"webpack Bundle Analyzer\"\n        src=\"/gatsby-bloga-2/static/081210eb1342fb8de549da3465a2cfad/fcda8/bundle-analyzer.png\"\n        srcset=\"/gatsby-bloga-2/static/081210eb1342fb8de549da3465a2cfad/12f09/bundle-analyzer.png 148w,\n/gatsby-bloga-2/static/081210eb1342fb8de549da3465a2cfad/e4a3f/bundle-analyzer.png 295w,\n/gatsby-bloga-2/static/081210eb1342fb8de549da3465a2cfad/fcda8/bundle-analyzer.png 590w,\n/gatsby-bloga-2/static/081210eb1342fb8de549da3465a2cfad/efc66/bundle-analyzer.png 885w,\n/gatsby-bloga-2/static/081210eb1342fb8de549da3465a2cfad/c83ae/bundle-analyzer.png 1180w,\n/gatsby-bloga-2/static/081210eb1342fb8de549da3465a2cfad/29007/bundle-analyzer.png 1600w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<h3><code class=\"language-text\">component---{route-name}-{unique-hash}.js</code></h3>\n<p><code class=\"language-text\">component---src-pages-contact-js-34c976efa1482a119a50.js</code> contains metadata that defines the necessary resources for a specific route. We‚Äôll come back to this‚Äîpromise!</p>\n<p>To tie it all together, the build process produces a <code class=\"language-text\">contact/index.html</code> file containing something like:</p>\n<div class=\"gatsby-highlight\" data-language=\"html\"><pre class=\"language-html\"><code class=\"language-html\"><span class=\"token doctype\">&lt;!DOCTYPE html></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>html</span> <span class=\"token attr-name\">lang</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>en<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>head</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>meta</span> <span class=\"token attr-name\">charset</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>utf-8<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>meta</span> <span class=\"token attr-name\">http-equiv</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>x-ua-compatible<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">content</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>ie=edge<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>meta</span>\n      <span class=\"token attr-name\">name</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>viewport<span class=\"token punctuation\">\"</span></span>\n      <span class=\"token attr-name\">content</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>width=device-width, initial-scale=1, shrink-to-fit=no<span class=\"token punctuation\">\"</span></span>\n    <span class=\"token punctuation\">/></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>meta</span> <span class=\"token attr-name\">name</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>generator<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">content</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>Gatsby 2.2.5<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>title</span><span class=\"token punctuation\">></span></span>Contact | Gatsby Code Splitting<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>title</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>meta</span> <span class=\"token attr-name\">name</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>theme-color<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">content</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>#663399<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>link</span>\n      <span class=\"token attr-name\">as</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>script<span class=\"token punctuation\">\"</span></span>\n      <span class=\"token attr-name\">rel</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>preload<span class=\"token punctuation\">\"</span></span>\n      <span class=\"token attr-name\">href</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>/webpack-runtime-0e11ed03533eb43aa22d.js<span class=\"token punctuation\">\"</span></span>\n    <span class=\"token punctuation\">/></span></span>\n<span class=\"gatsby-highlight-code-line\">    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>link</span> <span class=\"token attr-name\">as</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>script<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">rel</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>preload<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">href</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>/app-426166597c215dcde739.js<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/></span></span></span><span class=\"gatsby-highlight-code-line\">    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>link</span> <span class=\"token attr-name\">as</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>script<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">rel</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>preload<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">href</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>/9-f5d9c17474395c2890a3.js<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/></span></span></span>    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>link</span>\n      <span class=\"token attr-name\">as</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>script<span class=\"token punctuation\">\"</span></span>\n      <span class=\"token attr-name\">rel</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>preload<span class=\"token punctuation\">\"</span></span>\n      <span class=\"token attr-name\">href</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>/component---src-pages-contact-js-3e821a731407298f1654.js<span class=\"token punctuation\">\"</span></span>\n    <span class=\"token punctuation\">/></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>link</span>\n      <span class=\"token attr-name\">as</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>fetch<span class=\"token punctuation\">\"</span></span>\n      <span class=\"token attr-name\">rel</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>preload<span class=\"token punctuation\">\"</span></span>\n      <span class=\"token attr-name\">href</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>/static/d/686/path---contact-26-a-cd9-NZuapzHg3X9TaN1iIixfv1W23E.json<span class=\"token punctuation\">\"</span></span>\n      <span class=\"token attr-name\">crossorigin</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>use-credentials<span class=\"token punctuation\">\"</span></span>\n    <span class=\"token punctuation\">/></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>head</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>body</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">id</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>___gatsby<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span><span class=\"token style-attr language-css\"><span class=\"token attr-name\"> <span class=\"token attr-name\">style</span></span><span class=\"token punctuation\">=\"</span><span class=\"token attr-value\"><span class=\"token property\">outline</span><span class=\"token punctuation\">:</span>none</span><span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">tabindex</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>-1<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">role</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>group<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span><span class=\"token style-attr language-css\"><span class=\"token attr-name\"> <span class=\"token attr-name\">style</span></span><span class=\"token punctuation\">=\"</span><span class=\"token attr-value\"><span class=\"token property\">background</span><span class=\"token punctuation\">:</span>rebeccapurple<span class=\"token punctuation\">;</span><span class=\"token property\">margin-bottom</span><span class=\"token punctuation\">:</span>1.45rem</span><span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n          <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span><span class=\"token style-attr language-css\"><span class=\"token attr-name\"> <span class=\"token attr-name\">style</span></span><span class=\"token punctuation\">=\"</span><span class=\"token attr-value\"><span class=\"token property\">margin</span><span class=\"token punctuation\">:</span>0 auto<span class=\"token punctuation\">;</span><span class=\"token property\">max-width</span><span class=\"token punctuation\">:</span>960px<span class=\"token punctuation\">;</span><span class=\"token property\">padding</span><span class=\"token punctuation\">:</span>1.45rem 1.0875rem</span><span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>h1</span><span class=\"token style-attr language-css\"><span class=\"token attr-name\"> <span class=\"token attr-name\">style</span></span><span class=\"token punctuation\">=\"</span><span class=\"token attr-value\"><span class=\"token property\">margin</span><span class=\"token punctuation\">:</span>0</span><span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n              <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>a</span><span class=\"token style-attr language-css\"><span class=\"token attr-name\"> <span class=\"token attr-name\">style</span></span><span class=\"token punctuation\">=\"</span><span class=\"token attr-value\"><span class=\"token property\">color</span><span class=\"token punctuation\">:</span>white<span class=\"token punctuation\">;</span><span class=\"token property\">text-decoration</span><span class=\"token punctuation\">:</span>none</span><span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">href</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>/<span class=\"token punctuation\">\"</span></span>\n                <span class=\"token punctuation\">></span></span>Gatsby Default Starter<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>a</span>\n              <span class=\"token punctuation\">></span></span>\n            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>h1</span><span class=\"token punctuation\">></span></span>\n          <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span>\n        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span>\n<span class=\"gatsby-highlight-code-line\">        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span><span class=\"token style-attr language-css\"><span class=\"token attr-name\"></span><span class=\"gatsby-highlight-code-line\">          <span class=\"token attr-name\">style</span></span><span class=\"token punctuation\">=\"</span><span class=\"token attr-value\"><span class=\"token property\">margin</span><span class=\"token punctuation\">:</span>0 auto<span class=\"token punctuation\">;</span><span class=\"token property\">max-width</span><span class=\"token punctuation\">:</span>960px<span class=\"token punctuation\">;</span><span class=\"token property\">padding</span><span class=\"token punctuation\">:</span>0px 1.0875rem 1.45rem<span class=\"token punctuation\">;</span><span class=\"token property\">padding-top</span><span class=\"token punctuation\">:</span>0</span><span class=\"token punctuation\">\"</span></span></span><span class=\"gatsby-highlight-code-line\">        <span class=\"token punctuation\">></span></span></span><span class=\"gatsby-highlight-code-line\">          <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>h1</span><span class=\"token punctuation\">></span></span>Contact Us<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>h1</span><span class=\"token punctuation\">></span></span></span><span class=\"gatsby-highlight-code-line\">          <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>p</span><span class=\"token punctuation\">></span></span>Use the form below to get in touch<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>p</span><span class=\"token punctuation\">></span></span></span><span class=\"gatsby-highlight-code-line\">          <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>form</span><span class=\"token punctuation\">></span></span></span><span class=\"gatsby-highlight-code-line\">            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>label</span> <span class=\"token attr-name\">for</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>email<span class=\"token punctuation\">\"</span></span><span class=\"token style-attr language-css\"><span class=\"token attr-name\"> <span class=\"token attr-name\">style</span></span><span class=\"token punctuation\">=\"</span><span class=\"token attr-value\"><span class=\"token property\">display</span><span class=\"token punctuation\">:</span>block</span><span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>Email<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>label</span></span><span class=\"gatsby-highlight-code-line\">            <span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>input</span></span><span class=\"gatsby-highlight-code-line\">              <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>text<span class=\"token punctuation\">\"</span></span></span><span class=\"gatsby-highlight-code-line\">              <span class=\"token attr-name\">id</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>email<span class=\"token punctuation\">\"</span></span></span><span class=\"gatsby-highlight-code-line\">              <span class=\"token attr-name\">placeholder</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>Enter your email<span class=\"token punctuation\">\"</span></span></span><span class=\"gatsby-highlight-code-line\">              <span class=\"token attr-name\">value</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span><span class=\"token punctuation\">\"</span></span></span><span class=\"gatsby-highlight-code-line\">              <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>text-input<span class=\"token punctuation\">\"</span></span></span><span class=\"gatsby-highlight-code-line\">            <span class=\"token punctuation\">/></span></span></span><span class=\"gatsby-highlight-code-line\">          <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>form</span><span class=\"token punctuation\">></span></span></span><span class=\"gatsby-highlight-code-line\">          <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>footer</span><span class=\"token punctuation\">></span></span></span><span class=\"gatsby-highlight-code-line\">            ¬©</span><span class=\"gatsby-highlight-code-line\">            <span class=\"token comment\">&lt;!-- --></span>2019<span class=\"token comment\">&lt;!-- --></span>, Built with<span class=\"token comment\">&lt;!-- --></span></span><span class=\"gatsby-highlight-code-line\">            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>a</span> <span class=\"token attr-name\">href</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>https://www.gatsbyjs.org<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>Gatsby<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>a</span><span class=\"token punctuation\">></span></span></span><span class=\"gatsby-highlight-code-line\">          <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>footer</span><span class=\"token punctuation\">></span></span></span><span class=\"gatsby-highlight-code-line\">        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span></span>      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>body</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>html</span><span class=\"token punctuation\">></span></span></code></pre></div>\n<p>This is an optimized, HTML representation of the React component at <code class=\"language-text\">src/pages/contact.js</code> containing the <strong>minimal</strong> resources required for the page. Our users only load the resources they need for every single route. No more, no less. üî•</p>\n<p><em>Want to dive deeper? Much of this is encapsulated in our internal <a href=\"https://github.com/gatsbyjs/gatsby/blob/master/packages/gatsby/src/utils/webpack.config.js\">webpack config</a></em></p>\n<h2>Modern APIs in Gatsby</h2>\n<p>Gatsby uses modern browser APIs to both maximize performance and user experience‚Äîwhich oftentimes go hand in hand!‚Äîonly loading assets when they are necessary and likely to be requested. Specifically, the following APIs are crucial to the end user experience in Gatsby:</p>\n<ol>\n<li><code class=\"language-text\">IntersectionObserver</code> - an API to conditionally perform some action when an element enters the viewport/view</li>\n<li><code class=\"language-text\">link rel=&quot;prefetch&quot;</code> - an API to prefetch resources in the background when the browser is idle</li>\n<li><code class=\"language-text\">srcset</code> powering responsive images - a API to load the <em>smallest possible</em> image that matches the viewport of the requesting device</li>\n</ol>\n<p>Let‚Äôs get to it.</p>\n<h3><code class=\"language-text\">IntersectionObserver</code></h3>\n<p>If you‚Äôve ever browsed a Gatsby application, you‚Äôve probably noticed that links to internal routes feel like they load <em>instantly</em>. This in-app navigation is powered, in part, by an <code class=\"language-text\">IntersectionObserver</code>.</p>\n<p><em>Curious what an <code class=\"language-text\">IntersectionObserver</code> can do? Check out the following example. Emoji are used when an element is entering/leaving the viewport.</em></p>\n<iframe\n  src=\"https://codesandbox.io/embed/l70jj9p58m?fontsize=14\"\n  title=\"Intersection Observer Example\"\n  style=\"width:100%; height:500px; border:0; border-radius: 4px; overflow:hidden;\"\n  sandbox=\"allow-modals allow-forms allow-popups allow-scripts allow-same-origin\"\n/>\n<h4><code class=\"language-text\">gatsby-link</code> and <code class=\"language-text\">link rel=&quot;prefetch&quot;</code></h4>\n<p>The <code class=\"language-text\">Link</code> component exported by <code class=\"language-text\">gatsby</code> ships with an <code class=\"language-text\">IntersectionObserver</code>. The behavior is two-fold:</p>\n<ol>\n<li>\n<p>An <code class=\"language-text\">IntersectionObserver</code> is registered for all links</p>\n<ul>\n<li>This will register an <strong>idle</strong> <code class=\"language-text\">prefetch</code> for a request for that link‚Äôs resources</li>\n<li><a href=\"https://github.com/gatsbyjs/gatsby/blob/e0db68141c146ec532db22b0da2d86fcc467f37e/packages/gatsby-link/src/index.js#L25-L41\">See the code for <code class=\"language-text\">gatsby-link</code></a></li>\n</ul>\n</li>\n<li>\n<p>On <code class=\"language-text\">hover</code> a <code class=\"language-text\">fetch</code> will be used to send a <strong>non-idle</strong> request for that link‚Äôs resources</p>\n<ul>\n<li>This will use an <code class=\"language-text\">onMouseEnter</code> prop to make the resources available via our internal loader</li>\n<li><a href=\"https://github.com/gatsbyjs/gatsby/blob/e0db68141c146ec532db22b0da2d86fcc467f37e/packages/gatsby-link/src/index.js#L131-L135\">See the code for <code class=\"language-text\">gatsby-link</code></a></li>\n</ul>\n</li>\n</ol>\n<p>These two techniques, used together, create an experience that makes navigating around a Gatsby application feel seamless and incredibly fast. Gatsby‚Äôs use of modern APIs (particularly <code class=\"language-text\">IntersectionObserver</code>) optimistically, idly prefetch resources. Then, when we have a reasonable assurance that the user is <em>likely</em> to need the resource(s) (on a mouse enter), we make a <strong>strong</strong> request for the actual resources. More often than not‚Äîthe <code class=\"language-text\">prefetch</code> has <em>already</em> made the resources available, in the background ü§Ø</p>\n<p><em>Fun fact: there‚Äôs work to make this even smarter, powered by <a href=\"/gatsby-bloga-2/packages/gatsby-plugin-guess-js/\">Google Analytics and GuessJS</a>. This will idly prefetch pages likely to be navigated by the user based on the current route. We‚Äôre actually <a href=\"https://github.com/gatsbyjs/gatsby/pull/12351\">testing it</a> on gatsbyjs.org <strong>right now</strong>.</em></p>\n<p>But, but‚Ä¶ you exclaim! What about progressive enhancement? What about mobile? What about devices that are data constrained? You better believe we‚Äôve got ‚Äòem all handled.</p>\n<p><strong>Progressive Enhancement</strong></p>\n<p>The feature seamlessly falls back to default behavior if <code class=\"language-text\">IntersectionObserver</code> is not detected. In browsers that support it (<a href=\"https://developer.mozilla.org/en-US/docs/Web/API/Intersection_Observer_API#Browser_compatibility\">most!</a>) we‚Äôll send the idle <code class=\"language-text\">prefetch</code>. In browsers that don‚Äôt, we‚Äôll only use the hover interaction. As browsers continue to implement more of these modern APIs, you can rest assured that your Gatsby application will be using the best and most useful, in a way that degrades seamlessly for your end users.</p>\n<p><strong>Mobile</strong></p>\n<p>Most mobile browsers support <code class=\"language-text\">IntersectionObserver</code> but none (of course!) support the <code class=\"language-text\">onMouseEnter</code> event. This means that the strong, non-idle fetch will not be triggered on mobile. This is not necessarily ideal‚Äîbut the beauty of the feature is that the <code class=\"language-text\">prefetch</code> generally takes care of the necessary resource(s) being available.</p>\n<p><strong>Data-constrained devices</strong></p>\n<p>One of the most appealing things about using a framework like Gatsby is that we can bake-in micro-optimizations and make these available in incremental updates to all of <em>our</em> users making the performance optimizations available to all of <em>your</em> users. In particular, later versions of Chrome support an API that grants network information like type of connection (e.g. <code class=\"language-text\">slow-2g</code>, <code class=\"language-text\">2g</code>, etc.), whether the browser has a <code class=\"language-text\">saveData</code> hint enabled, and more. With the help of <a href=\"https://twitter.com/addyosmani\">@addyosmani</a> we‚Äôve baked this into our preloading logic. On devices with these hints or on slow connections, we disable the preloading to save data! It looks a little something like:</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token comment\">// Skip prefetching if we know user is on slow or constrained connection</span>\n<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">connection</span><span class=\"token template-punctuation string\">`</span></span> <span class=\"token keyword\">in</span> navigator<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>navigator<span class=\"token punctuation\">.</span>connection<span class=\"token punctuation\">.</span>effectiveType <span class=\"token operator\">||</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">includes</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">2g</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token boolean\">false</span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>navigator<span class=\"token punctuation\">.</span>connection<span class=\"token punctuation\">.</span>saveData<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token boolean\">false</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>See the <a href=\"https://github.com/gatsbyjs/gatsby/blob/be023447eb0f5bd4612a447098fc85c7afdf0cdf/packages/gatsby/cache-dir/loader.js#L227-L235\">code implementing this functionality here</a>.</p>\n<h3><code class=\"language-text\">srcset</code> powering Responsive Images</h3>\n<p>Whew. It‚Äôs been quite a ride. Finally, I‚Äôd like to discuss one of my favorite Gatsby components, specifically <a href=\"/gatsby-bloga-2/packages/gatsby-image/\"><code class=\"language-text\">gatsby-image</code></a>. This component <em>also</em> registers an <code class=\"language-text\">IntersectionObserver</code>, and uses it in an interesting, performance-focused manner. Let‚Äôs get to it.</p>\n<h4><code class=\"language-text\">gatsby-image</code></h4>\n<p>There are far, far, far too many otherwise decently performing websites that load a gargantuan 5Mb image request as a hero image. But‚Äîthankfully, this isn‚Äôt you! You use <code class=\"language-text\">gatsby-image</code> and you get all of the following:</p>\n<ul>\n<li>\n<p>Responsive, optimized images using a <code class=\"language-text\">srcset</code></p>\n<ul>\n<li>A <a href=\"https://developer.mozilla.org/en-US/docs/Web/HTML/Element/picture\"><code class=\"language-text\">picture</code></a> element with a <code class=\"language-text\">source srcset</code> is used</li>\n<li>This means that using several media queries, you load the smallest image that matches your device (e.g. mobile devices get smaller images, desktop devices get larger images, etc.)</li>\n<li>We even generate 2x DPi images for beautiful images, regardless of the screen quality!</li>\n</ul>\n</li>\n<li>\n<p>A base64 blurred image loaded by default</p>\n<ul>\n<li>This has two wins: 1) Larger images outside the viewport are not requested until they‚Äôre needed, and 2) The blurred image is in a container with the same dimensions as the real image‚Äîtherefore, no jumping when the image loads!</li>\n<li>Also see: <a href=\"/gatsby-bloga-2/packages/gatsby-plugin-sharp/#tracedsvg\">traced SVGs for a super slick alternative</a></li>\n</ul>\n</li>\n<li>\n<p>An <code class=\"language-text\">IntersectionObserver</code> that swaps the base image for the larger image, when the image is in the viewport</p>\n<ul>\n<li>See the <a href=\"https://github.com/gatsbyjs/gatsby/blob/7684b4f0126724521967f7c8d31d32ec8d9b5fa6/packages/gatsby-image/src/index.js#L45-L69\">image IntersectionObserver code here</a></li>\n</ul>\n</li>\n</ul>\n<p>And one of the best wins of all‚ÄîGatsby‚Äôs pluggable ecosystem and GraphQL data layer are both used to produce and pass the optimized images directly to this component. It looks something like:</p>\n<div class=\"gatsby-highlight\" data-language=\"jsx:title=src/components/hero.js\"><pre class=\"language-jsx:title=src/components/hero.js\"><code class=\"language-jsx:title=src/components/hero.js\">import React from &quot;react&quot;\nimport { graphql, useStaticQuery } from &quot;gatsby&quot;\nimport Image from &quot;gatsby-image&quot;\n\nexport default function AnActuallyGoodAndResponsiveHeroImage() {\n  const data = useStaticQuery(graphql`\n    file(relativePath: { eq: &quot;some-hero-image.jpg&quot; }) {\n      childImageSharp {\n        fluid(maxWidth: 1200) {\n          ...GatsbyImageSharpFluid\n        }\n      }\n    }\n  `)\n\n  return &lt;Image fluid={data.file.childImageSharp.fluid} alt=&quot;&quot; /&gt;\n}</code></pre></div>\n<p>Our static build process will create an optimized, responsive hero image as static HTML that looks something like:</p>\n<div class=\"gatsby-highlight\" data-language=\"html\"><pre class=\"language-html\"><code class=\"language-html\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>gatsby-image-wrapper<span class=\"token punctuation\">\"</span></span><span class=\"token style-attr language-css\"><span class=\"token attr-name\"> <span class=\"token attr-name\">style</span></span><span class=\"token punctuation\">=\"</span><span class=\"token attr-value\"><span class=\"token property\">position</span><span class=\"token punctuation\">:</span>fixed<span class=\"token punctuation\">;</span><span class=\"token property\">overflow</span><span class=\"token punctuation\">:</span>hidden</span><span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n  <span class=\"token comment\">&lt;!-- div to avoid loading jump --></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span><span class=\"token style-attr language-css\"><span class=\"token attr-name\"> <span class=\"token attr-name\">style</span></span><span class=\"token punctuation\">=\"</span><span class=\"token attr-value\"><span class=\"token property\">width</span><span class=\"token punctuation\">:</span>100%<span class=\"token punctuation\">;</span><span class=\"token property\">padding-bottom</span><span class=\"token punctuation\">:</span>152.45833333333334%</span><span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>img</span> <span class=\"token attr-name\">src</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>data:image/jpeg;base64,base64-optimized-image-here<span class=\"token punctuation\">\"</span></span><span class=\"token style-attr language-css\"><span class=\"token attr-name\"> <span class=\"token attr-name\">style</span></span><span class=\"token punctuation\">=\"</span><span class=\"token attr-value\"><span class=\"token property\">background-color</span><span class=\"token punctuation\">:</span> <span class=\"token function\">rgb</span><span class=\"token punctuation\">(</span>251<span class=\"token punctuation\">,</span> 250<span class=\"token punctuation\">,</span> 252<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token property\">position</span><span class=\"token punctuation\">:</span> absolute<span class=\"token punctuation\">;</span> <span class=\"token property\">top</span><span class=\"token punctuation\">:</span> 0px<span class=\"token punctuation\">;</span> <span class=\"token property\">bottom</span><span class=\"token punctuation\">:</span> 0px<span class=\"token punctuation\">;</span> <span class=\"token property\">opacity</span><span class=\"token punctuation\">:</span> 0<span class=\"token punctuation\">;</span> <span class=\"token property\">transition-delay</span><span class=\"token punctuation\">:</span> 0.35s<span class=\"token punctuation\">;</span> <span class=\"token property\">right</span><span class=\"token punctuation\">:</span> 0px<span class=\"token punctuation\">;</span> <span class=\"token property\">left</span><span class=\"token punctuation\">:</span> 0px<span class=\"token punctuation\">;</span></span><span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token comment\">&lt;!-- This picture element is added upon entry into the viewport with an IntersectionObserver --></span>\n<span class=\"gatsby-highlight-code-line\">  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>picture</span><span class=\"token punctuation\">></span></span></span><span class=\"gatsby-highlight-code-line\">    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>source</span> <span class=\"token attr-name\">srcset</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>/static/aa813/your-great-image.jpg 200w,</span><span class=\"gatsby-highlight-code-line\">      /static/d7872/your-great-image.jpg 400w,</span><span class=\"gatsby-highlight-code-line\">      /static/3be68/your-great-image.jpg 800w,</span><span class=\"gatsby-highlight-code-line\">      /static/55558/your-great-image.jpg 1200w,</span><span class=\"gatsby-highlight-code-line\">      /static/ca53f/your-great-image.jpg 1600w,</span><span class=\"gatsby-highlight-code-line\">      /static/2e134/your-great-image.jpg 2400w<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">sizes</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>(max-width: 800px) 100vw, 800px<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span></span><span class=\"gatsby-highlight-code-line\">    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>img</span> <span class=\"token attr-name\">alt</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span><span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">src</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>/static/3be68/your-great-image.jpg<span class=\"token punctuation\">\"</span></span><span class=\"token style-attr language-css\"><span class=\"token attr-name\"> <span class=\"token attr-name\">style</span></span><span class=\"token punctuation\">=\"</span><span class=\"token attr-value\"><span class=\"token property\">position</span><span class=\"token punctuation\">:</span> absolute<span class=\"token punctuation\">;</span> <span class=\"token property\">top</span><span class=\"token punctuation\">:</span> 0px<span class=\"token punctuation\">;</span> <span class=\"token property\">left</span><span class=\"token punctuation\">:</span> 0px<span class=\"token punctuation\">;</span> <span class=\"token property\">width</span><span class=\"token punctuation\">:</span> 100%<span class=\"token punctuation\">;</span> <span class=\"token property\">height</span><span class=\"token punctuation\">:</span> 100%<span class=\"token punctuation\">;</span> <span class=\"token property\">object-fit</span><span class=\"token punctuation\">:</span> cover<span class=\"token punctuation\">;</span> <span class=\"token property\">object-position</span><span class=\"token punctuation\">:</span> center center<span class=\"token punctuation\">;</span> <span class=\"token property\">opacity</span><span class=\"token punctuation\">:</span> 1<span class=\"token punctuation\">;</span> <span class=\"token property\">transition</span><span class=\"token punctuation\">:</span> opacity 0.5s ease 0s<span class=\"token punctuation\">;</span></span><span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span></span><span class=\"gatsby-highlight-code-line\">  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>picture</span><span class=\"token punctuation\">></span></span></span>  <span class=\"token comment\">&lt;!-- JavaScript disabled? No problem. --></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>noscript</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>picture</span><span class=\"token punctuation\">></span></span>\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>source</span> <span class=\"token attr-name\">srcSet</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>/static/aa813/your-great-image.jpg 200w,\n        /static/d7872/your-great-image.jpg 400w,\n        /static/3be68/your-great-image.jpg 800w,\n        /static/55558/your-great-image.jpg 1200w,\n        /static/ca53f/your-great-image.jpg 1600w,\n        /static/2e134/your-great-image.jpg 2400w<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">sizes</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>(max-width: 800px) 100vw, 800px<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/></span></span>\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>img</span> <span class=\"token attr-name\">src</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>/static/3be68/your-great-image.jpg<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">alt</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span><span class=\"token punctuation\">\"</span></span><span class=\"token style-attr language-css\"><span class=\"token attr-name\"><span class=\"token attr-name\">style</span></span><span class=\"token punctuation\">=\"</span><span class=\"token attr-value\"><span class=\"token property\">position</span><span class=\"token punctuation\">:</span>absolute<span class=\"token punctuation\">;</span><span class=\"token property\">top</span><span class=\"token punctuation\">:</span>0<span class=\"token punctuation\">;</span><span class=\"token property\">left</span><span class=\"token punctuation\">:</span>0<span class=\"token punctuation\">;</span><span class=\"token property\">transition</span><span class=\"token punctuation\">:</span>opacity 0.5s<span class=\"token punctuation\">;</span><span class=\"token property\">transition-delay</span><span class=\"token punctuation\">:</span>0.5s<span class=\"token punctuation\">;</span><span class=\"token property\">opacity</span><span class=\"token punctuation\">:</span>1<span class=\"token punctuation\">;</span><span class=\"token property\">width</span><span class=\"token punctuation\">:</span>100%<span class=\"token punctuation\">;</span><span class=\"token property\">height</span><span class=\"token punctuation\">:</span>100%<span class=\"token punctuation\">;</span><span class=\"token property\">object-fit</span><span class=\"token punctuation\">:</span>cover<span class=\"token punctuation\">;</span><span class=\"token property\">object-position</span><span class=\"token punctuation\">:</span>center</span><span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">/></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>picture</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>noscript</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span></code></pre></div>\n<p>For a demo of all you can do with <code class=\"language-text\">gatsby-image</code>, check out the example <a href=\"https://using-gatsby-image.gatsbyjs.org\">Using Gatsby Image</a>.</p>\n<p>The power and appeal of Gatsby is that we internalize all of these great APIs, performance techniques, and patterns. Enabling these (and improving with incremental releases of Gatsby!) allow you to focus on what matters: delivering compelling and engaging user experiences backed by your friendly, fast, and powerful web compiler: Gatsby.</p>\n<p>It‚Äôs been quite a ride üòÖ By this point, we‚Äôve covered the foundational techniques Gatsby uses to deliver a performance optimized application for your end users. However‚Äîto assert something is fast, you need to measure it. You need analytics, tools, and checks to assert that not only is your app fast but also just as important that it <em>remains</em> fast.</p>\n<h2>Techniques for measuring performance</h2>\n<p>With any application, even one with a rock-solid performance basis like Gatsby, the advice I‚Äôd give is to trust, but validate. It‚Äôs <em>unlikely</em> you‚Äôll introduce a significant performance regression with a new feature and pull request, but even the best of foundations can be torn down. ‚ÄúI think I‚Äôll load <em>six</em> fonts each in weights 100-900‚Äù, they said, and ‚ÄúOh, and I think two feedback libraries <em>and</em> a few analytics libraries are really going to drive conversion and put us over the edge,‚Äù said someone, assuredly, at some point.</p>\n<h3>Lighthouse</h3>\n<p>The quickest and easiest recommendation for measuring performance is to first and foremost use the tools available to you. Chrome has an excellent tool built-in, <a href=\"https://github.com/GoogleChrome/lighthouse\">Lighthouse</a> accessible via the ‚ÄúAudits‚Äù tab in Developer Tools (and fun fact‚ÄîGatsby‚Äôs very own <a href=\"https://github.com/wardpeet\">Ward Peeters</a> and <a href=\"https://twitter.com/marcysutton\">Marcy Sutton</a> are core contributors!).</p>\n<p>Lighthouse is accessible via the developer tools in Chrome: <code class=\"language-text\">F12</code> -> <code class=\"language-text\">Audits</code> and then <code class=\"language-text\">Run audit</code>. You‚Äôll be greeted with a result like:</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/gatsby-bloga-2/static/482be0461788395918f1734ede1477f4/6a5c3/lighthouse.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 63.51351351351351%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAIAAAAmMtkJAAAACXBIWXMAAAsSAAALEgHS3X78AAABwElEQVQoz4VS2Y7cIBCc//+5KNqNckgz2fHBYYMBmxszTtme7OQtrRYqGoouCi7tEdfrFePtdrvf703TABNCmntDCem6jhIKjErXth9N/9F0Yug555cYYwjBLGbUYlkW770wU4hxLWvMyQYHUEqZwxJSrOuac4kRBYB8eTwe27a1irzRnwBrrV+6b3wRwL1mb+QHAPZ87b+fxcm7d9LvxW27bEfo2XAxANRaCaPW2b1oNBs5ugBLNfkYoIFzRjg1Sm0nuR7x+Ix/4D6rFReLIS7BemejM8l5P5snGbgndFLT9r947GI36fU7//Ukx5QoY0JK+PG5Dw3zmjHCmwSXDvEn2Sbfa/okp5QYH5U2AKdq7PE50HnAPQmh4yjAP28B90JJ3CrgnYxTjdHzbNb66lxq0WFOOeHQxS7WuZf64osbnmRoG3QcVUghl7TmVFLcM8ScY4k+BZ+8i0YtZ2qpg7VP2adUOwfeyLFXQ68YANHAR+qhmwQxWGWt5K0kv4U1Yfv7zrCh5px4P2ppJqFGJo0yAxVogqngmM4jE3oySmqsevciozmcXr2FQcej+v1hg9vHiJrHH07+KCLBLHk3/w8buepk4t8CmgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Lighthouse Example\"\n        title=\"Lighthouse Example\"\n        src=\"/gatsby-bloga-2/static/482be0461788395918f1734ede1477f4/fcda8/lighthouse.png\"\n        srcset=\"/gatsby-bloga-2/static/482be0461788395918f1734ede1477f4/12f09/lighthouse.png 148w,\n/gatsby-bloga-2/static/482be0461788395918f1734ede1477f4/e4a3f/lighthouse.png 295w,\n/gatsby-bloga-2/static/482be0461788395918f1734ede1477f4/fcda8/lighthouse.png 590w,\n/gatsby-bloga-2/static/482be0461788395918f1734ede1477f4/efc66/lighthouse.png 885w,\n/gatsby-bloga-2/static/482be0461788395918f1734ede1477f4/c83ae/lighthouse.png 1180w,\n/gatsby-bloga-2/static/482be0461788395918f1734ede1477f4/6a5c3/lighthouse.png 1646w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p>Lighthouse will provide scores from 0 - 100 for a variety of meaningful categories, including performance, accessibility, and more. Actionable feedback is provided if the score is less than 100, so you can feel empowered to make improvements and maximize those üíØs!</p>\n<p>Lighthouse is a great <em>first</em> step to asserting whether or not your application is actually fast. If you are scoring near 100s (if you‚Äôre using Gatsby‚Äîyou probably are!) you can feel assured with a reasonable degree of confidence that your application is actually fast. However‚ÄîLighthouse can sometimes vary between runs and results can sometimes vary depending on which machine is used to run the test. To gain a greater degree of <em>certainty</em> that your application is fast I recommend another, complementary tool: Webpagetest.</p>\n<h3>WebPagetest</h3>\n<p><a href=\"https://webpagetest.org\">WebPagetest</a> is an amazing tool built by <a href=\"https://twitter.com/patmeenan\">Patrick Meenan</a>. You can tweak the device used in the tests to validate that your application works even on low-performing devices that tend to be CPU-constrained. You can use a slower network to ensure that you get an accurate representation of how your users could be interacting with your application in less-than-ideal network connections. You can even choose the location of where your test is run!</p>\n<p>I liken the relationship between Lighthouse and WebPagetest as similar to the relationship between a unit test (Lighthouse) and an end to end test (WebPagetest). A unit test gives you a fair degree of confidence that what you‚Äôre testing works like you expect. An end to end test gives you a near certainty that what you‚Äôre testing works as expected, because you‚Äôre testing in real-world conditions.</p>\n<p>Both are valuable‚Äîand both have their place!</p>\n<h3>Trust, but validate</h3>\n<p>As mentioned, performance is something that should be regularly monitored. Using tools like WebPagetest and Lighthouse are <strong>great</strong> techniques that should be used and help uncover performance problems (among other key concerns like accessibility improvements, SEO, etc.). However, the usage of these tools are oftentimes done in a reactionary, ad-hoc manner. Performing a Lighthouse test, discovering issues, and devoting a week or two to remediate is <em>all</em> too common.</p>\n<p>Why react to something (!) with manual, ad-hoc spot checking? What if we could remediate and diagnose at pull request time?</p>\n<p>Using Continuous Integration checks is a great technique that can catch regressions before merging, therefore catching regressions before <em>shipping</em> regressions. It looks a little something like this:</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/gatsby-bloga-2/static/a5b7cb89398af1391f683993845cedc8/ea7fb/ci-check.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 62.83783783783784%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAIAAAAmMtkJAAAACXBIWXMAAAsSAAALEgHS3X78AAAB3klEQVQoz1VSWW7dMAz0/T97gt6gvz1JUCR5ux1v2kUtlmS54+cHNJUHhGRwNOSIzbZttdbg8QXnPTlH3htrldZcCCGlVAqRyBljGOczY0opsha8xra/9McPZqVlYyGbyGZEaxaro9FRq2hUiqGUlNOyLAEIMZCPKeeG+t/28pOT5X1P17vrB/fobPvlhyl0ve8G3/UpxHWtW92OFXPlVEadGhzWutZlabv+2nYj4xMX7TAyqTV5pgzXlkuljV1SBnbFXJZUehkbdLzVEoKfyY9czDNDolQ70KdQGkSlrZDahXiQU8o+5kHF5llIXWJgFCYup5lNjCMbZOvgHElt1FMc5F0zF8SwlOkgw+34VP6a2DCiaolULsAmVAFNXISjJf9d+Vn2kx0XP1rqxrnv0bUAnwkJMsqeuQTGmWtDuazo9lDuRHgZtuUs3NKO8+PRzmArvYujXevSbk8OEZanwzMou5juLDSoGfw3/f4u794Gbcw+J87BXkuE4JwnIhCQiAc7UNaKS1/kP/T5Nn7cz/fLDet+Op8/T6fT+YJ5mqZpGAbv/eHO9m/Vp2FbXRPmKmhL2jgX0NeaS0Ws22s0sM37z+8ox1NtSgtotl13vd0wyRjAlCJwzOMLOP6H8BfwFuZcnnIwpAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Continuous Integration Status Check\"\n        title=\"Continuous Integration Status Check\"\n        src=\"/gatsby-bloga-2/static/a5b7cb89398af1391f683993845cedc8/fcda8/ci-check.png\"\n        srcset=\"/gatsby-bloga-2/static/a5b7cb89398af1391f683993845cedc8/12f09/ci-check.png 148w,\n/gatsby-bloga-2/static/a5b7cb89398af1391f683993845cedc8/e4a3f/ci-check.png 295w,\n/gatsby-bloga-2/static/a5b7cb89398af1391f683993845cedc8/fcda8/ci-check.png 590w,\n/gatsby-bloga-2/static/a5b7cb89398af1391f683993845cedc8/ea7fb/ci-check.png 788w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p>If you check out the <a href=\"https://github.com/DSchau/gatsby-perf-audit/pull/4\">pull request</a>, you can see that the failing CI status check alerts us of a possible performance regression that is introduced <em>in</em> the pull request. The check runs Lighthouse in a CI container, and will fail the check if our code in the pull request reduces the scores below their expected baselines.</p>\n<p>In this pull request, I <em>intentionally</em> introduce a few dependencies like Bootstrap, lodash, and‚Ä¶ jQuery because let‚Äôs at least make the performance problems clear and obvious! If you check out the <a href=\"https://circleci.com/gh/DSchau/gatsby-perf-audit/13?utm_campaign=vcs-integration-link&#x26;utm_medium=referral&#x26;utm_source=github-build-link\">CI logs</a> you can see the output from the failing CI check:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\"> ‚óè performance audit\n\n    expect(received).toBe(expected) // Object.is equality\n\n    Expected: 1\n    Received: 0.99\n\n      31 |   console.log(output(scores))\n      32 |\n    &gt; 33 |   expect(scores.performance).toBe(1)\n         |                              ^\n      34 |   expect(scores.accessibility).toBe(1)\n      35 |   expect(scores[&#39;best-practices&#39;]).toBeGreaterThanOrEqual(0.93)\n      36 |   expect(scores.seo).toBe(1)\n\n      at Object.toBe (lighthouse.test.js:33:30)\n\n  console.log lighthouse.test.js:31\n    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê\n    ‚îÇ performance    ‚îÇ 0.99 ‚îÇ\n    ‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§\n    ‚îÇ accessibility  ‚îÇ 0.92 ‚îÇ\n    ‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§\n    ‚îÇ best-practices ‚îÇ 0.93 ‚îÇ\n    ‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§\n    ‚îÇ seo            ‚îÇ 1    ‚îÇ\n    ‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§\n    ‚îÇ pwa            ‚îÇ 0.65 ‚îÇ\n    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò</code></pre></div>\n<p>If we set up a performance baseline (and we‚Äôre using Gatsby here, so let‚Äôs shoot for scores of üíØ), we can catch regressions at pull request time. Using Gatsby gives us some luxuries here in being performant <em>out of the box</em> but a performant default does not mean that you should rest easy, unconcerned of such <em>trivial</em> concerns as performance, accessibility, and more. Trust, but validate.</p>\n<h2>Wrap-up</h2>\n<p>Gatsby is <strong>great</strong> because we provide a solid foundation, smart defaults, and use modern web APIs, each of which are pillars on which to build incredibly performant web applications. In detailing each of these foundational areas, I hope it‚Äôs been made apparent the value that Gatsby has for not only developer experience but also in the very real benefit performance has on user experience. Use Gatsby. You‚Äôll thank us and your users will thank you.</p>\n<p>We can‚Äôt wait to see what you‚Äôll build üíú</p>","frontmatter":{"title":"Behind the Scenes: What makes Gatsby Great","date":"April 02, 2019","description":null}}},"pageContext":{"slug":"/docs/blog/2019-04-02-behind-the-scenes-what-makes-gatsby-great/","previous":{"fields":{"slug":"/docs/blog/2019-03-29-interview-with-david-eads/"},"frontmatter":{"title":"Interview with David Eads"}},"next":{"fields":{"slug":"/docs/blog/2019-04-05-health-brand-chooses-gatsby-to-level-up-its-modern-stack/"},"frontmatter":{"title":"Health Brand Chooses Gatsby to Level-Up Its Modern Stack"}}}}}