{"componentChunkName":"component---src-templates-blog-post-js","path":"/docs/blog/2019-01-25-blazing-fast-development-with-gatsby-and-sanity-io/","result":{"data":{"site":{"siteMetadata":{"title":"Gatsby Starter Blog"}},"markdownRemark":{"id":"094e7598-0e70-5c23-b6b5-3faaa3e0a2f3","excerpt":"Sanity.io is a content management system with real-time at its very core. We built the React.js editing environment as a real-time React.js app so you can…","html":"<p>Sanity.io is a content management system with real-time at its very core. We built the React.js <a href=\"https://github.com/sanity-io/sanity\">editing environment</a> as a real-time React.js app so you can collaborate on the same documents without locking. It connects to our document store through real-time APIs. Naturally, we’ve been looking for frontend frameworks that can reflect changes in real-time as well. Problem was, we didn’t know of a reasonable way to accomplish this for everyday needs.</p>\n<p>Then we came across <a href=\"/gatsby-bloga-2/blog/2018-07-17-announcing-gatsby-preview/\">Gatsby Preview</a>, a general way to get real-time previews that doesn’t involve custom code! When combining Sanity with Gatsby, we get the best of both worlds: A fully dynamic development experience where code and content is instantly reflected in preview.</p>\n<p>In January 2019 we shipped our new <a href=\"https://github.com/sanity-io/gatsby-source-sanity\">Sanity Gatsby Source</a> Plugin that uses the Sanity APIs to rebuild instantly as content changes. When developing this means a group of people can freely work together on both content models, UI design and the content itself. In real-time. Without rebuilds. This feels both a bit futuristic and pretty great. In the process we also to also make the static production builds themselves as fast as possible.</p>\n<p><a href=\"https://youtu.be/STtpXBvJmDA\">https://youtu.be/STtpXBvJmDA</a></p>\n<p>You can experience it yourself with the sample <a href=\"https://github.com/sanity-io/example-company-website-gatsby-sanity-combo\">company website</a> we built for the launch. We ship it in a monorepo along with a Sanity project that has content models for <em>people</em>, <em>project case studies</em> and <em>blogging</em>. We made it pretty minimal to make it easier to extend.</p>\n<h2>Get started, with minimal configuration</h2>\n<p>The Gatsby source plugin for Sanity comes with the ability to easily overlay drafts, compatibility with the <a href=\"/gatsby-bloga-2/packages/gatsby-image\">gatsby-image</a> plugin, no mysteriously missing types/fields, and a watch mode for instant preview of edits in development. We also made sure that it requires as little configuration as possible.</p>\n<p>Add the source plugin to your Gatsby project:</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token function\">npm</span> <span class=\"token function\">install</span> --save gatsby-source-sanity</code></pre></div>\n<p>The source plugin gives you a comprehensive GraphQL API in Gatsby for your structured content from Sanity. We strongly recommend using the <a href=\"/gatsby-bloga-2/docs/running-queries-with-graphiql/\">GraphiQL explorer</a> to test queries and familiarize yourself with the schema documentation. It’s super useful!</p>\n<p>Once you have installed the plugin, add this configuration to <code class=\"language-text\">gatsby-config.js</code>:</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\">module<span class=\"token punctuation\">.</span>exports <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  plugins<span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\n    <span class=\"token punctuation\">{</span>\n      resolve<span class=\"token operator\">:</span> <span class=\"token string\">\"gatsby-source-sanity\"</span><span class=\"token punctuation\">,</span>\n      options<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n        projectId<span class=\"token operator\">:</span> <span class=\"token string\">\"&lt;yourProjectId>\"</span><span class=\"token punctuation\">,</span>\n        dataset<span class=\"token operator\">:</span> <span class=\"token string\">\"&lt;yourDatasetName>\"</span><span class=\"token punctuation\">,</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<h2>Preview content changes with watch mode</h2>\n<p>The source plugin injects published content changes instantly, without reloading the pages in the browser. All patches to the content are streamed to you via a listener. This means that you won’t be burning API calls as you develop the site. To enable watch mode, include it in your configuration:</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\">module<span class=\"token punctuation\">.</span>exports <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  plugins<span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\n    <span class=\"token punctuation\">{</span>\n      resolve<span class=\"token operator\">:</span> <span class=\"token string\">\"gatsby-source-sanity\"</span><span class=\"token punctuation\">,</span>\n      options<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n        projectId<span class=\"token operator\">:</span> <span class=\"token string\">\"&lt;yourProjectId>\"</span><span class=\"token punctuation\">,</span>\n        dataset<span class=\"token operator\">:</span> <span class=\"token string\">\"&lt;yourDatasetName>\"</span><span class=\"token punctuation\">,</span>\n        watchMode<span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\n        overlayDrafts<span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\n        token<span class=\"token operator\">:</span> process<span class=\"token punctuation\">.</span>env<span class=\"token punctuation\">.</span><span class=\"token constant\">SANITY_READ_TOKEN</span><span class=\"token punctuation\">,</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>If you <a href=\"https://github.com/sanity-io/example-company-website-gatsby-sanity-combo#enable-gatsby-watch-mode-for-drafts\">add a token with read permissions</a> and set <code class=\"language-text\">overlayDrafts: true</code>, you will get <em>all</em> editing changes live. This also makes it possible for a team to collaborate on design, code, and content at the same time, across multiple devices. It makes developing a site with Gatsby even more fun!</p>\n<h2>Fast, frugal builds</h2>\n<p>The source plugin uses Sanity.io’s export API. It streams all your documents in one go. So it’s not only <em>very</em> fast, it’s also just a single API call for all your content. Regardless of the number of documents or their size. Thanks to this you can build your website with Gatsby thousands of times a month on the free developer plan (you can also add your card to the <a href=\"https://www.sanity.io/pricing/dev-2018-08-21\">dev plan</a> for an affordable pay-as-you-go option should you blow past the generous base quotas).</p>\n<p>You also avoid time consuming processing of images. Our image pipeline scales and crops the images for you and we have already baked in Low-Quality-Image-Placeholder (LQIP) into the image asset data structure so you don’t need to extract it yourself to have it be part of your build. This while keeping compatibility with <code class=\"language-text\">gatsby-image</code>. We keep your image assets on a global edge cache and store the exact version you asked for to keep it fast.</p>\n<p>We think some people might prefer to keep assets as part of their build and are thinking of including an option for this as well. <a href=\"https://slack.sanity.io\">Let us know</a> if you’re one of them!</p>\n<h2>No accidentally missing fields or types</h2>\n<p>Most source plugins generate the internal Gatsby GraphQL API from the content available at any given moment. In other words: types and fields can be missing depending on what content is present or not. This can be a bit hard to work with, and in the worst case scenario, it breaks your build when you remove the last document that has content for specific kind of field.</p>\n<p>The Sanity.io source plugin automatically fetches the schema definition to make sure that all your types and fields are present if you deploy a <a href=\"https://www.sanity.io/help/graphql-beta\">GraphQL API</a> for your Sanity project (run <code class=\"language-text\">sanity graphql deploy</code> in the Sanity CLI in your project folder).</p>\n<p>There’s some excellent work being done in the Gatsby community to provide an official and better solution for this down the road. As far as we know, no other source plugin solves this problem right now.</p>\n<h2>The Power of Portable Text</h2>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/gatsby-bloga-2/static/7ac7b66a3d82d89dd2a5d2090d588c8b/29114/portable-text.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 56.08108108108109%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsSAAALEgHS3X78AAABrklEQVQoz4VSS0sCYRT1T/QD2vQLat0iaNWiVb8k2hauwlUtiiCIIjIh0gZULBdhk6QhDIaa5iNfM2m+Rh3fxul+1sg4Gi0+7nxz7z333PMdg9LuoNlqQ43jb6WFbC6PQqmM4bCHwdcXWp3uKKcetVZ7DPoka2Jg7V4fsdQ7gkEBxxY3rJwTNVmmug5yogSpUPyp/SWh9hu0lwYBVeU6lG4P3f4Qb6EQeJ7H8pYPm8ZDAAOEI1GEIq/I5kV0aKi2f8yQ/WDTypUqYvE4BGryrq/haHUFCsG8hKJw3XlQrzcgCAIuLRYCzENuNKcZ6rUrkmYOlwvWhXlsLC0iQCzPz06xZ9qC5/4WngceZrMZoigikUpNrD1eWQVt06rSRwGiJCEdDsPBccTmCqbdbZwZ53CwvwOOc8BqvUY6k514zKmVtZFp6fU/44KY2Gw3eHz0wO08gd3uQCAQoEcR0aLhsxwy8cpqslKT8eTzw0egeWoukQyFz9qIFdOObTJhMU2cCchskcnmRo3szmRIJBNIko3kpoI/vasF1GuhFZsBMxlmMdOznDK2vvg/AL0PvwGgqyqQOHFbCQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Portable Text\"\n        title=\"Portable Text\"\n        src=\"/gatsby-bloga-2/static/7ac7b66a3d82d89dd2a5d2090d588c8b/fcda8/portable-text.png\"\n        srcset=\"/gatsby-bloga-2/static/7ac7b66a3d82d89dd2a5d2090d588c8b/12f09/portable-text.png 148w,\n/gatsby-bloga-2/static/7ac7b66a3d82d89dd2a5d2090d588c8b/e4a3f/portable-text.png 295w,\n/gatsby-bloga-2/static/7ac7b66a3d82d89dd2a5d2090d588c8b/fcda8/portable-text.png 590w,\n/gatsby-bloga-2/static/7ac7b66a3d82d89dd2a5d2090d588c8b/efc66/portable-text.png 885w,\n/gatsby-bloga-2/static/7ac7b66a3d82d89dd2a5d2090d588c8b/c83ae/portable-text.png 1180w,\n/gatsby-bloga-2/static/7ac7b66a3d82d89dd2a5d2090d588c8b/29114/portable-text.png 1920w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p>With Sanity.io, rich text content is stored as <a href=\"https://www.portabletext.org\">Portable Text</a>, deeply typed and highly structured. This enables you to offer a WYSIWYG experience for yourself and your authors, but without all the markup mess. You also can get rid of <code class=\"language-text\">dangerouslyInsertInnerHTML</code> in your Gatsby templates, and replace it with custom React components at render time. In Sanity Studio you can use those same React components as inline previews for custom content types.</p>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">/*\nSo instead of this:\n&lt;div dangerouslySetInnerHTML={{__html: post.html}} />\nYou can do this:\n*/</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token keyword\">import</span> React <span class=\"token keyword\">from</span> <span class=\"token string\">\"react\"</span>\n<span class=\"token keyword\">import</span> PortableText <span class=\"token keyword\">from</span> <span class=\"token string\">\"@sanity/block-content-to-react\"</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> <span class=\"token parameter\">post</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">(</span>\n  <span class=\"token operator\">&lt;</span>PortableText\n    serializers<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span>\n      types<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token function-variable function\">code</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token punctuation\">{</span> node <span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">(</span>\n          <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>pre</span> <span class=\"token attr-name\">data-language</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>node<span class=\"token punctuation\">.</span>language<span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n            </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>code</span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">{</span>node<span class=\"token punctuation\">.</span>code<span class=\"token punctuation\">}</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>code</span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n          </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>pre</span><span class=\"token punctuation\">></span></span>\n        <span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span>\n    blocks<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>post<span class=\"token punctuation\">.</span>_bodyRaw<span class=\"token punctuation\">}</span>\n  <span class=\"token operator\">/</span><span class=\"token operator\">></span>\n<span class=\"token punctuation\">)</span></code></pre></div>\n<h2>Full <code class=\"language-text\">gatsby-image</code> support</h2>\n<p>Sanity already comes with a capable and easy to use image pipeline on a superfast CDN with <a href=\"https://www.sanity.io/docs/front-ends/presenting-images\">transforms on demand</a>, but if you want to use the same frontend components with a mix of remote or local sources or prefer the functionality of the <code class=\"language-text\">gatsby-image</code> library, we have made it easy for you to leverage that. Additionally, you’ll have access to all that handy image metadata, like aspect ratios, dimensions, color palettes, the optional EXIF data and geotags via the API.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/gatsby-bloga-2/static/fd5a8571191b492c173f5ca00e245a8e/29114/hotspot-cropping.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 56.08108108108109%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsSAAALEgHS3X78AAADGElEQVQozx2S3U+TdxiG3+1gi0FH6bdtaWmhb2nfFiyOgpSBMlsBCRLESgCj1DmhqUPcIGRjMINsbgc78WDJsiw7MFOXOXagA2T9EITyWWaYisCBWZbNbH/EtR87eA6f67nv574lvd6KquAwXm8tTYEKdDojOVoTVqeHUx3nOBiowWJzYC+UKZI9+MuD1De00iDmdHuUQDBMONKL40CQnP12pMO1dYSPhmgMhQiFG6g/3kJLS0QsneRsV5Tvv/2Gn2/fYnriJyYnJkj8co/09BQLyRTP17NcuTxAzbEzeNxeGptOINmK/JjtCiargrmgFIvTj0+p5LU9ViKnzrKanmHyxzuspGZYn02xnE6QSSdZTCZ5kpkn1nOJtnNDBKrr+Pjqp0i5WjtvaAtQaR1oDS50hmLMFh97VU56L8TpPR9lbGSE2Ht9XBkYYGPhEUuphDiQ4Le5ND09cb68cYfunn6GhgVQY3KjNsqodbKAedAbfWiNJejMft7tvkiuWkNf32Xi8RidXV28eLzO59ev8+HwMOOfjQvIMDvbf5Cemyfc+QGS3uoTyz40OjdavQeNUUGlU8h3VHIxegG7LHO8uZmKqir6L8X5e+t3orFero1f4+H0fYZGP2Fn509e/vUvsf73kcz5XvRCmVYA1QKYZ1DI0RQjK7W80x3F5nJRL4Bmp4uPhgb5Z2eTe3d/IDubZvbBJIMjo6xkn7EpoIOjY0haYVGl8Yg/KuQKZXkGL3vyikVdGumIRFBb8mlubcXnL+OLsau83NokJZLe/eVuQMFQmIKKCuQjR3BWHUKqcxfjsblRbMKugO3Ve3k9V+bto210no6gN1uQPaIFAnzz6694sZFlcyXD1toy84kZDgXLqa7281ZdEHeZgtTktnKyxEHHQZm2QAmK6wCvCmDoWBt3b35H5tcplhLToj4Jniwt8GxlgY3FRzxdzjD3YAqns5CAt4iach+lRTak2sL9nPDaiJQ5idX4aK18k1f2ybS3n2dtdobt9SW2s7uzyvPVZaFu8X/Y07VFklP3sZpMeMwGSp024dLMf1kr1h1L94jAAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Setting hotspot and cropping in Sanity Studio\"\n        title=\"Setting hotspot and cropping in Sanity Studio\"\n        src=\"/gatsby-bloga-2/static/fd5a8571191b492c173f5ca00e245a8e/fcda8/hotspot-cropping.png\"\n        srcset=\"/gatsby-bloga-2/static/fd5a8571191b492c173f5ca00e245a8e/12f09/hotspot-cropping.png 148w,\n/gatsby-bloga-2/static/fd5a8571191b492c173f5ca00e245a8e/e4a3f/hotspot-cropping.png 295w,\n/gatsby-bloga-2/static/fd5a8571191b492c173f5ca00e245a8e/fcda8/hotspot-cropping.png 590w,\n/gatsby-bloga-2/static/fd5a8571191b492c173f5ca00e245a8e/efc66/hotspot-cropping.png 885w,\n/gatsby-bloga-2/static/fd5a8571191b492c173f5ca00e245a8e/c83ae/hotspot-cropping.png 1180w,\n/gatsby-bloga-2/static/fd5a8571191b492c173f5ca00e245a8e/29114/hotspot-cropping.png 1920w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<h2>Sanity.io + Gatsby.js = Perfect JAMstack companions</h2>\n<p>Gatsby has already set high standards for developer experience by striking a good balance between code and configuration. We have worked hard to make it as effortless as possible to use <a href=\"https://www.sanity.io\">Sanity.io</a> as a content backend with Gatsby, and we hope that you will enjoy building websites with this combo.</p>\n<p>If you quickly want to get started with a full JAMstack combo, check out the <a href=\"https://github.com/sanity-io/example-company-website-gatsby-sanity-combo\">company website example</a> we put up. It features both a Studio configuration and a website template with projects, blog, people, and pages. With configuration files to put the website on either <a href=\"https://vercel.com\">Vercel</a> or <a href=\"https://netlify.com\">Netlify</a>. You should be up in minutes.</p>\n<p>We’re very excited to see whatever you do with it and welcome you to come with all your questions, feedback, and ideas in <a href=\"https://slack.sanity.io\">our developer community</a>.</p>","frontmatter":{"title":"Blazing fast development with Gatsby and Sanity.io","date":"January 25, 2019","description":null}}},"pageContext":{"slug":"/docs/blog/2019-01-25-blazing-fast-development-with-gatsby-and-sanity-io/","previous":{"fields":{"slug":"/docs/blog/2019-01-24-swag-store/"},"frontmatter":{"title":"Gatsby Swag Store Case Study"}},"next":{"fields":{"slug":"/docs/blog/2019-01-28-building-a-large-ecommerce-website-with-gatsby-at-daniel-wellington/"},"frontmatter":{"title":"Building a large, internationalized e-commerce website with Gatsby at Daniel Wellington"}}}}}