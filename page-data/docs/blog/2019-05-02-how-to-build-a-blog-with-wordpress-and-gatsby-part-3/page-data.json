{"componentChunkName":"component---src-templates-blog-post-js","path":"/docs/blog/2019-05-02-how-to-build-a-blog-with-wordpress-and-gatsby-part-3/","result":{"data":{"site":{"siteMetadata":{"title":"Gatsby Starter Blog"}},"markdownRemark":{"id":"b1b6ad00-0e95-53e8-a695-cd8a81e0ac60","excerpt":"Note: This is part two in a series of posts about Gatsby.js and WordPress. You can find Part One here, and Part Two here. In the third part of this series about…","html":"<blockquote>\n<p>Note: This is part two in a series of posts about Gatsby.js and WordPress. You can find <a href=\"/gatsby-bloga-2/blog/2019-04-26-how-to-build-a-blog-with-wordpress-and-gatsby-part-1\">Part One here</a>, and <a href=\"/gatsby-bloga-2/blog/2019-04-30-how-to-build-a-blog-with-wordpress-and-gatsby-part-2\">Part Two here</a>.</p>\n</blockquote>\n<p>In the third part of this series about WordPress and Gatsby.js, you will be creating pages using templates and components with data from WordPress.</p>\n<p>So far, I’ve talked about what themes and plugins to use for a WordPress backend and why. You have also created a new Gatsby site and set it up to create routes for your blog posts programmatically. You will be using the same skills for some of the things in this post since you probably want to have a default template for your static pages. After that, you’ll create React.js components in the <code class=\"language-text\">/pages</code> directory which will replace the default template for the desired pages, in this case your home page.</p>\n<h2>Creating a page template</h2>\n<p>As you’ll recall from the last post, you should create a page template before adding the <code class=\"language-text\">createPages</code> API to the gatsby-node.js file so it has something to call. To do this, you’ll create a file in the templates directory called PageTemplate.js using the code below:</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token function\">touch</span> ./src/templates/Page.js</code></pre></div>\n<p>Just like with the blog post template, you can probably just use a <a href=\"https://www.iamtimsmith.com/blog/class-components-vs-stateless-functional-components/\">stateless functional component</a> for this. Like before, you won’t cover how to create a component in this article, but you can read about <a href=\"https://www.iamtimsmith.com/blog/how-to-create-a-component/\">creating a React.js component here</a>.</p>\n<p>I will go ahead and start off with a generic template again and then fill it out later with the appropriate data. The code below will get a simple template created for us to use for pages for now:</p>\n<div class=\"gatsby-highlight\" data-language=\"jsx:title=src/templates/page.js\"><pre class=\"language-jsx:title=src/templates/page.js\"><code class=\"language-jsx:title=src/templates/page.js\">import React from &quot;react&quot;\nimport Layout from &quot;../components/layout&quot;\n\nconst PageTemplate = () =&gt; (\n  &lt;Layout&gt;\n    &lt;h1&gt;Page Template&lt;/h1&gt;\n  &lt;/Layout&gt;\n)\n\nexport default PageTemplate</code></pre></div>\n<h2>Adding pages to gatsby-node.js</h2>\n<p>Awesome! Now that you have your page template created, you can add pages to the gatsby-node.js file. First, you will import the template just like you did for the BlogPostTemplate. Then you will add the allWordpressPage piece to the GraphQL query. Finally, you will use the <code class=\"language-text\">createPage</code> API to create pages based on the information retrieved from the GraphQL query and use the Page template to build the pages automatically. Below is the finished gatsby-node.js file. See if you can spot the things I mentioned for the pages.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript:title=gatsby-node.js\"><pre class=\"language-javascript:title=gatsby-node.js\"><code class=\"language-javascript:title=gatsby-node.js\">/**\n * Implement Gatsby&#39;s Node APIs in this file.\n *\n * See: https://www.gatsbyjs.org/docs/node-apis/\n */\n\n// You can delete this file if you&#39;re not using it\nconst path = require(`path`)\n\nexports.createPages = async ({ graphql, actions, reporter }) =&gt; {\n  const { createPage } = actions\n  const BlogPostTemplate = path.resolve(&quot;./src/templates/BlogPost.js&quot;)\n  const PageTemplate = path.resolve(&quot;./src/templates/Page.js&quot;)\n\n  const result = await graphql(`\n    {\n      allWordpressPost {\n        edges {\n          node {\n            slug\n            wordpress_id\n          }\n        }\n      }\n      allWordpressPage {\n        edges {\n          node {\n            slug\n            wordpress_id\n          }\n        }\n      }\n    }\n  `)\n\n  if (result.errors) {\n    reporter.panicOnBuild(`Error while running GraphQL query.`)\n    return\n  }\n\n  const BlogPosts = result.data.allWordpressPost.edges\n  BlogPosts.forEach(post =&gt; {\n    createPage({\n      path: `/post/${post.node.slug}`,\n      component: BlogPostTemplate,\n      context: {\n        id: post.node.wordpress_id,\n      },\n    })\n\n    const Pages = result.data.allWordpressPage.edges\n    Pages.forEach(page =&gt; {\n      createPage({\n        path: `/${page.node.slug}`,\n        component: PageTemplate,\n        context: {\n          id: page.node.wordpress_id,\n        },\n      })\n    })\n  })\n}</code></pre></div>\n<p>Just like before, you can test this to make sure the pages were created as expected by starting your development server and visiting <code class=\"language-text\">http://localhost:8000/stuff</code> to get a list of all of the available pages. Again, this is only available in a development environment since a live site will show a different 404 page. You should see an <code class=\"language-text\">/about</code> page and a <code class=\"language-text\">/sample-page</code> page in there. If so, your gatsby-node.js file worked and you can update the template to show the data you want.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/gatsby-bloga-2/static/4fd290679c03fff8956938069cfc5ab9/07a9c/gatsby1.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 56.08108108108109%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsSAAALEgHS3X78AAAA7klEQVQoz6WSW4+DIBSE+f+/0PtDH6TWuwKKwpkVtrYxTVZ3d5IvICGTOQ4sDEMkSYI0TRHHMaIoQpZlniAIwDmHExH9yH6HtW2Lqqo81lr8Vbsp67oOjrquMY4jhBCevu/9t1LqhZTSr9M0Hc611u+ETdPApdyNdlO3OgNjzCn7ZN6Q5znKsvzXuIeRhQRmn5hOf/ylUspCYdGf6ejV7DHBmVjzGNCVElotGxqTmKHG+Wn5Tn5V7H5fkMQreL7iURgMvYGeDZaFsK7HcS4ZFsWK281uTdP2dGh7LrQ1TBiG770xvzS0luC40uAVfQEWB2A43sadngAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"See a list of available pages\"\n        title=\"See a list of available pages\"\n        src=\"/gatsby-bloga-2/static/4fd290679c03fff8956938069cfc5ab9/fcda8/gatsby1.png\"\n        srcset=\"/gatsby-bloga-2/static/4fd290679c03fff8956938069cfc5ab9/12f09/gatsby1.png 148w,\n/gatsby-bloga-2/static/4fd290679c03fff8956938069cfc5ab9/e4a3f/gatsby1.png 295w,\n/gatsby-bloga-2/static/4fd290679c03fff8956938069cfc5ab9/fcda8/gatsby1.png 590w,\n/gatsby-bloga-2/static/4fd290679c03fff8956938069cfc5ab9/efc66/gatsby1.png 885w,\n/gatsby-bloga-2/static/4fd290679c03fff8956938069cfc5ab9/c83ae/gatsby1.png 1180w,\n/gatsby-bloga-2/static/4fd290679c03fff8956938069cfc5ab9/07a9c/gatsby1.png 1440w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<h2>Updating the page template</h2>\n<p>Since you have your page routes set up, you can start adding to the template. This will look very similar to the BlogPost.js file with only a few differences. In your blog, you aren’t going to have a featured image for static pages, so you can go ahead and leave that piece out of the query. You also don’t need a date or author for the pages since they don’t change. Essentially all you’ll need is a title and content along with an excerpt for the SEO component.</p>\n<p>The end result is a basic component as shown below:</p>\n<div class=\"gatsby-highlight\" data-language=\"jsx:title=src/templates/page.js\"><pre class=\"language-jsx:title=src/templates/page.js\"><code class=\"language-jsx:title=src/templates/page.js\">import React from &quot;react&quot;\nimport { graphql } from &quot;gatsby&quot;\nimport Layout from &quot;../components/layout.js&quot;\nimport SEO from &quot;../components/seo&quot;\n\nconst PageTemplate = ({ data }) =&gt; (\n  &lt;Layout&gt;\n    &lt;SEO\n      title={data.wordpressPage.title}\n      description={data.wordpressPage.excerpt}\n    /&gt;\n    &lt;h1&gt;{data.wordpressPage.title}&lt;/h1&gt;\n    &lt;div dangerouslySetInnerHTML={{ __html: data.wordpressPage.content }} /&gt;\n  &lt;/Layout&gt;\n)\n\nexport default PageTemplate\n\nexport const query = graphql`\n  query($id: Int!) {\n    wordpressPage(wordpress_id: { eq: $id }) {\n      title\n      excerpt\n      content\n    }\n  }\n`</code></pre></div>\n<p>I mentioned at the end of <a href=\"/gatsby-bloga-2/blog/2019-04-30-how-to-build-a-blog-with-wordpress-and-gatsby-part-2\">part two</a> that configuring the gatsby-node.js file is probably the most difficult part of this whole thing. Since you worked your way through that already and understand how it works, setting up another content type was cake, right?</p>\n<p><a href=\"https://giphy.com/gifs/reaction-office-space-that-was-easy-zcCGBRQshGdt6\">https://giphy.com/gifs/reaction-office-space-that-was-easy-zcCGBRQshGdt6</a></p>\n<p>Now if you visit the about page at <code class=\"language-text\">http://localhost:8000/about</code>, you can see the data coming in from WordPress. If you inspect the page and look at the head, you can also see that the title and meta tags are being updated in the head because of the SEO component!</p>\n<h2>Creating pages in the pages directory</h2>\n<p>Gatsby provides some awesome out-of-the-box routing. Anything you create in the <code class=\"language-text\">/pages</code> directory will automatically create a route for you. For instance, if you were to create a file called <code class=\"language-text\">gatsby-is-awesome.js</code>, Gatsby.js would see that and create a route called <code class=\"language-text\">http://localhost:8000/gatsby-is-awesome</code>.</p>\n<p>You can also see that the starter default comes with a few pages already in the <code class=\"language-text\">/pages</code> directory. The index page is what will show when a user visits <code class=\"language-text\">http://localhost:8000/</code>. There is also a file called page-2.js which is just a simple page to show how linking works. Finally, there is a 404.js available which is the 404 page that shows when your Gatsby site is live.</p>\n<p>Since you want your blog to show up on the homepage, you can edit the file called <code class=\"language-text\">index.js</code> to do this. Let’s take a look at this file before you make any changes:</p>\n<div class=\"gatsby-highlight\" data-language=\"jsx:title=src/pages/index.js\"><pre class=\"language-jsx:title=src/pages/index.js\"><code class=\"language-jsx:title=src/pages/index.js\">import React from &quot;react&quot;\nimport { Link } from &quot;gatsby&quot;\n\nimport Layout from &quot;../components/layout&quot;\nimport Image from &quot;../components/image&quot;\nimport SEO from &quot;../components/seo&quot;\n\nconst IndexPage = () =&gt; (\n  &lt;Layout&gt;\n    &lt;SEO title=&quot;Home&quot; keywords={[`gatsby`, `application`, `react`]} /&gt;\n    &lt;h1&gt;Hi people&lt;/h1&gt;\n    &lt;p&gt;Welcome to your new Gatsby site.&lt;/p&gt;\n    &lt;p&gt;Now go build something great.&lt;/p&gt;\n    &lt;div style={{ maxWidth: `300px`, marginBottom: `1.45rem` }}&gt;\n      &lt;Image /&gt;\n    &lt;/div&gt;\n    &lt;Link to=&quot;/page-2/&quot;&gt;Go to page 2&lt;/Link&gt;\n  &lt;/Layout&gt;\n)\n\nexport default IndexPage</code></pre></div>\n<p>You are going to remove everything after the SEO tag but before the closing Layout tag and replace it with your own stuff. You can also use a query pretty similar to the one in the blog post template except for the content piece. You can just use the excerpt provided by the WordPress API.</p>\n<p>To keep things basic, you’ll just create a list of recent blog posts with an image, title, author, date, and excerpt. Each of the items in this list should link to the individual blog post for readers. Below is the code to create this layout. It’s pretty straightforward and looks very similar to your blog post template with the exception of the map function which iterates over the items in an array.</p>\n<div class=\"gatsby-highlight\" data-language=\"jsx:title=src/pages/index.js\"><pre class=\"language-jsx:title=src/pages/index.js\"><code class=\"language-jsx:title=src/pages/index.js\">import React from &quot;react&quot;\nimport { graphql, Link } from &quot;gatsby&quot;\nimport Img from &quot;gatsby-image&quot;\n\nimport Layout from &quot;../components/layout&quot;\nimport SEO from &quot;../components/seo&quot;\n\nconst IndexPage = ({ data }) =&gt; (\n  &lt;Layout&gt;\n    &lt;SEO title=&quot;Home&quot; keywords={[`gatsby`, `application`, `react`]} /&gt;\n    &lt;ul style={{ listStyle: &quot;none&quot; }}&gt;\n      {data.allWordpressPost.edges.map(post =&gt; (\n        &lt;li style={{ padding: &quot;20px 0&quot;, borderBottom: &quot;1px solid #ccc&quot; }}&gt;\n          &lt;Link\n            to={`/post/${post.node.slug}`}\n            style={{ display: &quot;flex&quot;, color: &quot;black&quot;, textDecoration: &quot;none&quot; }}\n          &gt;\n            &lt;Img\n              sizes={post.node.acf.feat_img.localFile.childImageSharp.sizes}\n              alt={post.node.title}\n              style={{ width: &quot;25%&quot;, marginRight: 20 }}\n            /&gt;\n            &lt;div style={{ width: &quot;75%&quot; }}&gt;\n              &lt;h3\n                dangerouslySetInnerHTML={{ __html: post.node.title }}\n                style={{ marginBottom: 0 }}\n              /&gt;\n              &lt;p style={{ margin: 0, color: &quot;grey&quot; }}&gt;\n                Written by {post.node.author.name} on {post.node.date}\n              &lt;/p&gt;\n              &lt;div dangerouslySetInnerHTML={{ __html: post.node.excerpt }} /&gt;\n            &lt;/div&gt;\n          &lt;/Link&gt;\n        &lt;/li&gt;\n      ))}\n    &lt;/ul&gt;\n  &lt;/Layout&gt;\n)\n\nexport default IndexPage\n\nexport const query = graphql`\n  query {\n    allWordpressPost {\n      edges {\n        node {\n          title\n          excerpt\n          slug\n          author {\n            name\n          }\n          date(formatString: &quot;MMMM DD, YYYY&quot;)\n          acf {\n            feat_img {\n              localFile {\n                childImageSharp {\n                  sizes(maxWidth: 600) {\n                    ...GatsbyImageSharpSizes\n                  }\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n`</code></pre></div>\n<p>And here’s what it looks like when you visit the homepage of your blog:</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/gatsby-bloga-2/static/3f887c362141374a087a1fa0107660d3/07a9c/gatsby2.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 55.4054054054054%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsSAAALEgHS3X78AAACE0lEQVQoz3WRS2sTYRSG83M01a3SX6BFKW5EKGqsC0FaFBdVG8SFG1eiYhuQdKPWuLMuihTrQhNHsSCteAmZTJ1M5p7bTKchc+nMvH7fJxMmVQ88nLmc83LOezK57AIujC3i3IFHmBlfwq3JEuYnniJ/Yhk3JpYxf7KEy0eLyB1cwPShwpBcdhG0dz+ZT6s1JHxeq+PjuojKWxUcyRtv6gQe3GoV5Vc/UCGUV74zWP3rOtL9lAxSsUfIf41x/QOP299iNFsGJHkbsiZB0SVopgzVaJJ3EbsDm1RH2B+ZMIwQ7pEfUQTLjXHxnY/plxwuvfch6R0oUhPNpgypIUFVVJiGCUM3oesGFFmF53qIwphpUC02YRzHTD0IQ2z8klEWTJbtnR3Ytg3LstDr9eA4DgaDAVzXZQRBgKQ/0RgR9P0Bnt87jQczR1C6fwbV6k9sbm2RXIWiKGi32zBNE51OB61WC/1+/3+Cf7ywrTbOH89i7tRhksewLdTQIKs2RBGyTPxTVWiaxsR1XWfPvu8jPdTIhI6zi2eFx6isvMCT4hJp0Nk0dDJKt9tlKyd4njfs/adgELi4W7yJ/MNZFO5cha6pMAyDQSeiaya16Uh/GxHsEfPPzh7DlWvjmJuaQp0XUKvVwPM8BEEg6zeGSJIEkViR9vEvQdfz8aXMQSyvg+M2yZUdduEEuiK9LIV6R4miaETwN8XjBbgvKT6zAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Finished blog home page\"\n        title=\"Finished blog home page\"\n        src=\"/gatsby-bloga-2/static/3f887c362141374a087a1fa0107660d3/fcda8/gatsby2.png\"\n        srcset=\"/gatsby-bloga-2/static/3f887c362141374a087a1fa0107660d3/12f09/gatsby2.png 148w,\n/gatsby-bloga-2/static/3f887c362141374a087a1fa0107660d3/e4a3f/gatsby2.png 295w,\n/gatsby-bloga-2/static/3f887c362141374a087a1fa0107660d3/fcda8/gatsby2.png 590w,\n/gatsby-bloga-2/static/3f887c362141374a087a1fa0107660d3/efc66/gatsby2.png 885w,\n/gatsby-bloga-2/static/3f887c362141374a087a1fa0107660d3/c83ae/gatsby2.png 1180w,\n/gatsby-bloga-2/static/3f887c362141374a087a1fa0107660d3/07a9c/gatsby2.png 1440w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p>It’s looking pretty good so far. You’re getting pretty close to being done, you just have a few more things to change and you’re ready to start blogging!</p>\n<p><a href=\"https://giphy.com/gifs/twitter-file-maximum-qLWdMYX1NYF2g\">https://giphy.com/gifs/twitter-file-maximum-qLWdMYX1NYF2g</a></p>\n<h2>Changing the header component</h2>\n<p>One of the first things I notice about the blog pictured above is the header. It doesn’t look bad, but you probably don’t want your blog to say “Gatsby Default Starter”. There are a few ways you can change this, which I’ll go over real quick.</p>\n<h3>In the gatsby-config.js file</h3>\n<p>In the gatsby-config.js file, you can see a piece at the top called <code class=\"language-text\">siteMetadata</code> with a title, description, and author. This is where some basic information is kept about the project for the SEO component, but also for the site name.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript:title=gatsby-config.js\"><pre class=\"language-javascript:title=gatsby-config.js\"><code class=\"language-javascript:title=gatsby-config.js\">module.exports = {\n  siteMetadata: {\n    title: `Gatsby Default Starter`,\n    description: `Kick off your next, great Gatsby project with this default starter. This barebones starter ships with the main Gatsby configuration files you might need.`,\n    author: `@gatsbyjs`,\n  },\n  plugins: [ ... ],\n}</code></pre></div>\n<p>The title you’re seeing in the header comes from the title listed here. You can change it to whatever you’d like your site to be called. Usually when building a WordPress site, I get all of my data for this from WordPress but in the case of a site using markdown or something different you may want to use the stuff located here.</p>\n<h3>In the header component</h3>\n<p>Since you are building a blog using WordPress and want your users to have full control over the data, you should get your site name from WordPress so if it ever changes the user can update it. Fortunately, WordPress makes this available to us through the API, so you can query it in GraphQL like so:</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/gatsby-bloga-2/static/4c44510a02636cd6249be5c0e49b4a60/07a9c/gatsby3.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 55.4054054054054%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsSAAALEgHS3X78AAAA2ElEQVQoz7WT6w6CMAxGef/HNEJAdmc3QPa5IQozkBASS062H+tpga4oywpN80BLKAghEEJAKZUhI4wySCniXoLHMxlcgDGOpqUoOm3QCAtle0whIEVY1k+E+NCW41ZR1HcKJToYbVesm7HOo7DO4TlNa/JGFjYFhNKoqQInCpp10LxbVg1j3rIkLYZh+CbtkWKKBbUx8L6H63tY73MW2aFwr0Nt0qutib8cdph9u6xDm3WS9ntcEh7J/ic8+iGXhOM44kycFs43Qco4S2ks/C4uzmoamzPCF8etW5bMSBuNAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"GraphQL query to get siteName from WordPress\"\n        title=\"GraphQL query to get siteName from WordPress\"\n        src=\"/gatsby-bloga-2/static/4c44510a02636cd6249be5c0e49b4a60/fcda8/gatsby3.png\"\n        srcset=\"/gatsby-bloga-2/static/4c44510a02636cd6249be5c0e49b4a60/12f09/gatsby3.png 148w,\n/gatsby-bloga-2/static/4c44510a02636cd6249be5c0e49b4a60/e4a3f/gatsby3.png 295w,\n/gatsby-bloga-2/static/4c44510a02636cd6249be5c0e49b4a60/fcda8/gatsby3.png 590w,\n/gatsby-bloga-2/static/4c44510a02636cd6249be5c0e49b4a60/efc66/gatsby3.png 885w,\n/gatsby-bloga-2/static/4c44510a02636cd6249be5c0e49b4a60/c83ae/gatsby3.png 1180w,\n/gatsby-bloga-2/static/4c44510a02636cd6249be5c0e49b4a60/07a9c/gatsby3.png 1440w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p>Using queries works a bit differently inside of components. Rather than just writing a query which drops data into your page or template, you have to use a new component called <code class=\"language-text\">StaticQuery</code> which is designed specifically for using queries inside of components.</p>\n<div class=\"gatsby-highlight\" data-language=\"jsx:title=src/components/header.js\"><pre class=\"language-jsx:title=src/components/header.js\"><code class=\"language-jsx:title=src/components/header.js\">import { Link } from &quot;gatsby&quot;\nimport PropTypes from &quot;prop-types&quot;\nimport React from &quot;react&quot;\n\nconst Header = ({ siteTitle }) =&gt; (\n  &lt;header\n    style={{\n      background: `rebeccapurple`,\n      marginBottom: `1.45rem`,\n    }}\n  &gt;\n    &lt;div\n      style={{\n        margin: `0 auto`,\n        maxWidth: 960,\n        padding: `1.45rem 1.0875rem`,\n      }}\n    &gt;\n      &lt;h1 style={{ margin: 0 }}&gt;\n        &lt;Link\n          to=&quot;/&quot;\n          style={{\n            color: `white`,\n            textDecoration: `none`,\n          }}\n        &gt;\n          {siteTitle}\n        &lt;/Link&gt;\n      &lt;/h1&gt;\n    &lt;/div&gt;\n  &lt;/header&gt;\n)\n\nHeader.propTypes = {\n  siteTitle: PropTypes.string,\n}\n\nHeader.defaultProps = {\n  siteTitle: ``,\n}\n\nexport default Header</code></pre></div>\n<p>If you take a quick look at the existing header component, you will see that a site-title is being passed in as a prop which is then used to display the site title from <code class=\"language-text\">gatsby-config.js</code> in the header. What you are going to do is use the <code class=\"language-text\">StaticQuery</code> component provided by Gatsby and use a query prop to run your query and then a render prop to actually render out your component like you normally would. You can see below how you do this in code:</p>\n<div class=\"gatsby-highlight\" data-language=\"jsx:title=src/components/header.js\"><pre class=\"language-jsx:title=src/components/header.js\"><code class=\"language-jsx:title=src/components/header.js\">import { StaticQuery, graphql, Link } from &quot;gatsby&quot;\nimport React from &quot;react&quot;\n\nconst Header = () =&gt; (\n  &lt;StaticQuery\n    query={graphql`\n      query {\n        wordpressSiteMetadata {\n          name\n        }\n      }\n    `}\n    render={data =&gt; (\n      &lt;header\n        style={{\n          background: `rebeccapurple`,\n          marginBottom: `1.45rem`,\n        }}\n      &gt;\n        &lt;div\n          style={{\n            margin: `0 auto`,\n            maxWidth: 960,\n            padding: `1.45rem 1.0875rem`,\n            display: `flex`,\n            justifyContent: `space-between`,\n            alignItems: `center`,\n          }}\n        &gt;\n          &lt;h1 style={{ margin: 0 }}&gt;\n            &lt;Link\n              to=&quot;/&quot;\n              style={{\n                color: `white`,\n                textDecoration: `none`,\n              }}\n            &gt;\n              {data.wordpressSiteMetadata.name}\n            &lt;/Link&gt;\n          &lt;/h1&gt;\n        &lt;/div&gt;\n      &lt;/header&gt;\n    )}\n  /&gt;\n)\n\nexport default Header</code></pre></div>\n<p>The header component above looks a little different than it originally did, but as you start to dig into it a bit more you can see it hasn’t changed much. You essentially just wrapped your header in the StaticQuery component and then ran your query inside of that component to give the header the necessary data.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/gatsby-bloga-2/static/a028b4271a078e09c245549d1204a402/07a9c/gatsby4.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 55.4054054054054%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsSAAALEgHS3X78AAAB/ElEQVQoz32RzWvTcBjH+1949G/w7eDRi+JBPHlxIB7my0EQD6I33WHbZXoTiqCIL6DInA60TIuda8FN+kLRQbq0tE3SdMmSvqy2tFuTj/klRrrq/MGH50nI8833+3silw5HCZk8FOXWqafcPfuC6XMvvf4Zl4885MrRvYh34tvR2ZDIRlZHUMjoFL2ay2yytGoT/9YgvaaQWZbIrsjkkgGZLwXyqRKlvIGc22QjE8yHRBg7ny2Y+LDOZLzEx2qXuiqj1KooWgVNV1C9XtRm28Zhd3yciDN0EOwOXe/RIb0Fs7kBc/kdsvUdOg0Lc8vCMExsu0G7vU27tU2j0aTb7eE6LqGG4I9D13H8amjfWXo1Q+LtPYrSGqVShWqlgmmatFotT7BNp9PxxLrBnOvudRg2w2FgPxF7ztWTB7h+5iCxd08oeoKFgoSiKNRqNTRN86uu675wKBoKjwgO/ZpMLPN4dopHc9OkkinPyU8sy/JpNpu+w5DBYLC/oPM78g8pzVT0Jg/u3yb7dQXTE6rXdd+ViDx+/hM5cBj7tMjEtWPcuHCa+OJ7KkoVSZKQZZlyuYyqqn5scQW2be/vUGxLHEXVWV9OkEmuUlbqXrRgEb1ez//pKCJVKPSPOwyW8mZhgTvnjzNz8QSv5+f9qIZh+AsQCGGxYUG/3//L4S/DNg1q28hZowAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Your Gatsby.js blog after updating the header component\"\n        title=\"Your Gatsby.js blog after updating the header component\"\n        src=\"/gatsby-bloga-2/static/a028b4271a078e09c245549d1204a402/fcda8/gatsby4.png\"\n        srcset=\"/gatsby-bloga-2/static/a028b4271a078e09c245549d1204a402/12f09/gatsby4.png 148w,\n/gatsby-bloga-2/static/a028b4271a078e09c245549d1204a402/e4a3f/gatsby4.png 295w,\n/gatsby-bloga-2/static/a028b4271a078e09c245549d1204a402/fcda8/gatsby4.png 590w,\n/gatsby-bloga-2/static/a028b4271a078e09c245549d1204a402/efc66/gatsby4.png 885w,\n/gatsby-bloga-2/static/a028b4271a078e09c245549d1204a402/c83ae/gatsby4.png 1180w,\n/gatsby-bloga-2/static/a028b4271a078e09c245549d1204a402/07a9c/gatsby4.png 1440w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<h3>Adding a Menu to the Header</h3>\n<p>Let’s take it a step further and say your user wants a menu in the header that he or she can update from WordPress. If you’ll recall in the <a href=\"/gatsby-bloga-2/blog/2019-04-26-how-to-build-a-blog-with-wordpress-and-gatsby-part-1\">first part of this series</a>, I mentioned a plugin called WP API Menus which will make your menus available in the Rest API.</p>\n<p>When you were setting your gatsby-config.js file in the <a href=\"/gatsby-bloga-2/blog/2019-04-30-how-to-build-a-blog-with-wordpress-and-gatsby-part-2\">second part of the series</a>, you just stuck with the default routes provided in the gatsby-source-wordpress docs. The WP API Menus plugin creates a few new routes for those endpoints, so the first thing you need to do is add these endpoints to the gatsby-config.js file.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript:title=gatsby-config.js\"><pre class=\"language-javascript:title=gatsby-config.js\"><code class=\"language-javascript:title=gatsby-config.js\">module.exports = {\n  siteMetadata: {\n    title: `Gatsby Default Starter`,\n    description: `Kick off your next, great Gatsby project with this default starter. This barebones starter ships with the main Gatsby configuration files you might need.`,\n    author: `@gatsbyjs`,\n  },\n  plugins: [\n    `gatsby-plugin-react-helmet`,\n    {\n      resolve: `gatsby-source-filesystem`,\n      options: {\n        name: `images`,\n        path: `${__dirname}/src/images`,\n      },\n    },\n    `gatsby-transformer-sharp`,\n    `gatsby-plugin-sharp`,\n    {\n      resolve: `gatsby-plugin-manifest`,\n      options: {\n        name: `gatsby-starter-default`,\n        short_name: `starter`,\n        start_url: `/`,\n        background_color: `#663399`,\n        theme_color: `#663399`,\n        display: `minimal-ui`,\n        icon: `src/images/gatsby-icon.png`, // This path is relative to the root of the site.\n      },\n    },\n    {\n      resolve: &quot;gatsby-source-wordpress&quot;,\n      options: {\n        // I have created a dummy site for us to use with the plugins we discussed\n        baseUrl: &quot;using-wordpress-with-gatsby.iamtimsmith.com&quot;,\n        protocol: &quot;https&quot;,\n        hostingWPCOM: false,\n        // We will be using some advanced custom fields\n        useACF: true,\n        acfOptionPageIds: [],\n        verboseOutput: false,\n        perPage: 100,\n        searchAndReplaceContentUrls: {\n          sourceUrl: &quot;https://www.using-wordpress-with-gatsby.iamtimsmith.com&quot;,\n          replacementUrl: &quot;https://localhost:8000&quot;,\n        },\n        // Set how many simultaneous requests are sent at once.\n        concurrentRequests: 10,\n        includedRoutes: [\n          &quot;**/categories&quot;,\n          &quot;**/posts&quot;,\n          &quot;**/pages&quot;,\n          &quot;**/media&quot;,\n          &quot;**/tags&quot;,\n          &quot;**/taxonomies&quot;,\n          &quot;**/users&quot;,\n          &quot;**/*/*/menus&quot;, // &lt;== Menu api endpoint\n          &quot;**/*/*/menu-locations&quot;, // &lt;== Menu api endpoint\n        ],\n        excludedRoutes: [],\n        normalizer: function ({ entities }) {\n          return entities\n        },\n      },\n    },\n    `gatsby-plugin-sitemap`,\n    // this (optional) plugin enables Progressive Web App + Offline functionality\n    // To learn more, visit: https://gatsby.dev/offline\n    // &#39;gatsby-plugin-offline&#39;,\n  ],\n}</code></pre></div>\n<p>If you look at the code above, you’ll notice you have added two new routes to the gatsby-source-wordpress. These routes are created automatically by the plugin inside of WordPress without any additional configuration. Remember, after making changes to files outside of the src folder, you need to restart your development server by running <code class=\"language-text\">gatsby develop</code>. After restarting, you can visit <code class=\"language-text\">http://localhost:8000/___graphql</code> and query for the menu information, which will look like the screenshot below.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/gatsby-bloga-2/static/b67ad819a89f248f60e647db2ded39c2/07a9c/gatsby6.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 55.4054054054054%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsSAAALEgHS3X78AAABGUlEQVQoz42TW26DMBBF2f9CupP+dgetWjVRlDiMH8E2YMzt2MSRS0mFpaMRoDm6jO3mcDxCXC6Q1EIIAWoljNLQWsMYk9EMtQStFJRmuEqZkHcUiCTOokVjncOH8PikALIBow+Y3IgpBJQ1zzNaQfg+ES50w1V16KyD8z2s8w/Sc+NY+Pqu8PKm8SWnRVCJSk2Cg1A4s9SQgeVm5/osKSRpMwwDt0Qm5JocSVBIK3K11nI6w+NR6E4StvubMAvHccyJYhYt+e6eXwm1uXFKjy412oUirFNmYWmqBXWNMT5mtv7F9btNIZ7McGsTdiVcC+uEtWyLZYbVJqzZEj6TZWGoztt/a7cw3wS+FelY9H2/ife8u/x9j/AHeUxZqZ4DFV4AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"GraphiQL query to get menu items from WordPress\"\n        title=\"GraphiQL query to get menu items from WordPress\"\n        src=\"/gatsby-bloga-2/static/b67ad819a89f248f60e647db2ded39c2/fcda8/gatsby6.png\"\n        srcset=\"/gatsby-bloga-2/static/b67ad819a89f248f60e647db2ded39c2/12f09/gatsby6.png 148w,\n/gatsby-bloga-2/static/b67ad819a89f248f60e647db2ded39c2/e4a3f/gatsby6.png 295w,\n/gatsby-bloga-2/static/b67ad819a89f248f60e647db2ded39c2/fcda8/gatsby6.png 590w,\n/gatsby-bloga-2/static/b67ad819a89f248f60e647db2ded39c2/efc66/gatsby6.png 885w,\n/gatsby-bloga-2/static/b67ad819a89f248f60e647db2ded39c2/c83ae/gatsby6.png 1180w,\n/gatsby-bloga-2/static/b67ad819a89f248f60e647db2ded39c2/07a9c/gatsby6.png 1440w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p>The final step is to add this query into your static query and create the menu itself in the header component. You can just drop this in under the <code class=\"language-text\">wordpressSiteMetadata</code> piece. Once you have it added into the query, you can just use a <code class=\"language-text\">map()</code> function to iterate over the menu items and create it dynamically, allowing the user to update it through WordPress. Doing it this way does require us to specify which menu you want, so you need the name of the menu which is set in WordPress. In this case, your menu is called Main Menu so you will use that in your query.</p>\n<div class=\"gatsby-highlight\" data-language=\"jsx:title=src/components/header.js\"><pre class=\"language-jsx:title=src/components/header.js\"><code class=\"language-jsx:title=src/components/header.js\">import { StaticQuery, graphql, Link } from &quot;gatsby&quot;\nimport React from &quot;react&quot;\n\nconst Header = () =&gt; (\n  &lt;StaticQuery\n    query={graphql`\n      query {\n        wordpressSiteMetadata {\n          name\n        }\n        wordpressWpApiMenusMenusItems(name: { eq: &quot;Main Menu&quot; }) {\n          items {\n            title\n            object_slug\n          }\n        }\n      }\n    `}\n    render={data =&gt; (\n      &lt;header\n        style={{\n          background: `rebeccapurple`,\n          marginBottom: `1.45rem`,\n        }}\n      &gt;\n        &lt;div\n          style={{\n            margin: `0 auto`,\n            maxWidth: 960,\n            padding: `1.45rem 1.0875rem`,\n            display: `flex`,\n            justifyContent: `space-between`,\n            alignItems: `center`,\n          }}\n        &gt;\n          &lt;h1 style={{ margin: 0 }}&gt;\n            &lt;Link\n              to=&quot;/&quot;\n              style={{\n                color: `white`,\n                textDecoration: `none`,\n              }}\n            &gt;\n              {data.wordpressSiteMetadata.name}\n            &lt;/Link&gt;\n          &lt;/h1&gt;\n          &lt;ul style={{ listStyle: `none`, display: `flex`, margin: 0 }}&gt;\n            {data.wordpressWpApiMenusMenusItems.items.map(item =&gt; (\n              &lt;li key={item.object_slug} style={{ margin: `0 10px` }}&gt;\n                &lt;Link\n                  to={`/${item.object_slug}`}\n                  style={{\n                    color: `white`,\n                    textDecoration: `none`,\n                    fontFamily: `sans-serif`,\n                  }}\n                &gt;\n                  {item.title}\n                &lt;/Link&gt;\n              &lt;/li&gt;\n            ))}\n          &lt;/ul&gt;\n        &lt;/div&gt;\n      &lt;/header&gt;\n    )}\n  /&gt;\n)\n\nexport default Header</code></pre></div>\n<p>That’s a good looking component! Let’s see what it looks like when you visit the site:</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/gatsby-bloga-2/static/c9a3761bf130b14a5e780795acb4fe0f/07a9c/gatsby7.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 55.4054054054054%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsSAAALEgHS3X78AAACIElEQVQoz3WRy2sTURTG8+doo90oSv8CFTfdiFCkNRUCalFcVEpAF25ciYo1EtKNz+5aF1aUdqGJqVWRFq3GTKedTCbzymumY8w8OjOf916dMvFx4ce593LOx3fOSYwNTON08i5G99zB2cN5ZI4/wtSxB7gyPItzQzMY2zuN1L4sy0klf8Uzg/eQPpBD+mAO44NZUI2IxNtnFUS8e7GB0qKA4pKM5SUBywvfUHj6BcXf0Hthfp3Edaw85/Dh5SZWFjjENRKInR1C5lOIy284XP0cQmrqkOQt1FWRUIWiS5C1GmqKAOuHQbJ9/HkSvh/A3wmAIIBhhxh/5SI1V0L6tQtRbUESRdRqEsSqCLkuQ9d0aCpFQ528HdtB4IdMg2oxh2EYMnXP9/F+S0KB11k0t7dhmiYMw0Cn04FlWej1erBtm+F5HqL6SKNP0HV7eHzjBG6dP4QnN0+iXP6K1bU1EsvETR3NZhO6rqPVaqHRaKDb7f5PMGAP02hi9OgAJof3k5jEJl9BlbRaFQRIEpmfLENRFCauqiq7u66LuKk+h5b1HQ+zORTnZ3E/P0MKVOaGOqO0223WcoTjOLu1/xT0PBvX81PI3J5A9tpFqIoMTdMY1BFtM8qNn/hfn2CHDP/UxBFcuDSEyZERbHA8KpUKOI4Dz/Ok/eouItm+QEYRn+Nfgrbj4mOhBKGwiFJplWzZYhuOoC3SzVLo7ChBEPQJ/gRdYAVNzavdhQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Blog after adding menu to header\"\n        title=\"Blog after adding menu to header\"\n        src=\"/gatsby-bloga-2/static/c9a3761bf130b14a5e780795acb4fe0f/fcda8/gatsby7.png\"\n        srcset=\"/gatsby-bloga-2/static/c9a3761bf130b14a5e780795acb4fe0f/12f09/gatsby7.png 148w,\n/gatsby-bloga-2/static/c9a3761bf130b14a5e780795acb4fe0f/e4a3f/gatsby7.png 295w,\n/gatsby-bloga-2/static/c9a3761bf130b14a5e780795acb4fe0f/fcda8/gatsby7.png 590w,\n/gatsby-bloga-2/static/c9a3761bf130b14a5e780795acb4fe0f/efc66/gatsby7.png 885w,\n/gatsby-bloga-2/static/c9a3761bf130b14a5e780795acb4fe0f/c83ae/gatsby7.png 1180w,\n/gatsby-bloga-2/static/c9a3761bf130b14a5e780795acb4fe0f/07a9c/gatsby7.png 1440w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<h2>Wrapping up</h2>\n<p>Well done! You now have a functioning blog using WordPress and Gatsby. There are more things you can do to add custom functionality such as custom post types, galleries, and more, but this is enough to get you started for now. As you’ve seen, this stack is the best of both worlds since clients and users get the awesome experience of content creating with WordPress and as a developer you can leverage the amazing capabilities of Gatsby. As usual, go forth and make the internet a better place to be!</p>\n<p>The <a href=\"https://github.com/iamtimsmith/building-a-blog-with-wordpress-and-gatsby\">code for this post</a> can be found on GitHub.</p>\n<p>If you have any thoughts or questions, you can find me on Twitter at <a href=\"https://twitter.com/iam_timsmith\">@iam_timsmith</a>!</p>","frontmatter":{"title":"How To Build A Blog with WordPress and Gatsby.js - Part 3","date":"May 02, 2019","description":null}}},"pageContext":{"slug":"/docs/blog/2019-05-02-how-to-build-a-blog-with-wordpress-and-gatsby-part-3/","previous":{"fields":{"slug":"/docs/blog/2019-04-30-how-to-build-a-blog-with-wordpress-and-gatsby-part-2/"},"frontmatter":{"title":"How To Build A Blog with WordPress and Gatsby.js - Part 2"}},"next":{"fields":{"slug":"/docs/blog/2019-05-02-growing-housecall-pro-by-973-percent/"},"frontmatter":{"title":"Growing Housecall Pro by 973% with Gatsby"}}}}}